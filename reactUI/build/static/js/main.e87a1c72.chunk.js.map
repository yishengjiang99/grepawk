{"version":3,"sources":["components/Window.js","components/Table.js","components/ListView.js","FileExplorer/GFileSelector.js","Broadcast/BroadcastClient.js","components/Modal.js","SearchBar.js","FileExplorer/Composer.js","constants.js","APICalls.js","Terminal.js","HUD.js","Video.js","Camera.js","Broadcast/MediaObject.js","Broadcast/Broadcast.js","Broadcast/BroadcastViewerClient.js","Broadcast/Watch.js","AppIconGrid.js","FileExplorer/APIFileSystem.js","FileExplorer/ChromeFileSystem.js","FileExplorer/VFS.js","FileExplorer/GFileListItem.js","FileExplorer/Finder.js","Desktop.js","index.js"],"names":["Window","props","onNavBarClick","e","mode","target","className","setState","prev","maximized","minimized","closed","ipc","pid","renderNavTop","onMouseDown","onNavbarMouseDown","onClick","title","window","addEventListener","onNavbarMouseMove","onNavbarMouseUp","mouseX","clientX","mouseY","clientY","lastMouseX","lastMouseY","isDragging","removeEventListener","state","dragging","deltaX","deltaY","left","top","onCornerMouseDown","onCornerMouseMove","onCornerMouseUp","isResizing","width","height","renderFooter","windowInfo","style","float","this","boxClass","sizeStyle","cursor","zIndex","children","React","Component","Table","require","Parser","renderHeaders","headers","key","map","header","i","renderLink","cmd","desc","ref","createRef","clickedCmd","renderBody","rows","row","renderTableRow","val","opt","img_url","src","border","ListView","list","item","description","GFileSelector","componentDidMount","renderFileSelectedList","files_selected","renderControlPanel","status","onCancel","onSave","onFileChange","alert","type","id","name","onChange","onFilesChange","peerRTCConfig","RTCIceServers","url","credential","username","signalServerURL","location","origin","BroadcasterClient","config","console","signalConnection","host_uuid","hostname","onEvent","log","peerConnections","localTracks","audioCtx","AudioContext","audioMeter","createAnalyser","trackDescriptor","track","dimensions","live","updateTrackForPeers","Object","values","forEach","client","updateTracks","Uint8Array","requestUserStream","Promise","resolve","reject","a","navigator","mediaDevices","getDisplayMedia","stream","getUserMedia","video","audio","Error","addStream","getTracks","idx","push","addTrack","removeStream","removeTrack","stop","startBroadcast","channelName","WebSocket","onmessage","event","data","JSON","parse","client_uuid","peerConnection","RTCPeerConnection","metadataChannel","createDataChannel","trackMap","sendMetaData","readyState","setTimeout","metadata","keys","trackId","active","payload","send","stringify","onopen","onicecandidate","candidate","to_uuid","onnegotiationneeded","evt","createOffer","offer","setLocalDescription","tracks","set_sdp_anwser","answer","setRemoteDescription","addIceCandidate","BroadcasterRTCConnection","user_join_request","user_sent_sdp_answser","user_sent_peer_ice_candidate","json","channel","onerror","Modal","clickedSave","onSubmit","answers","stateAnwsers","questions","question","for","value","initialAnswers","modalStyle","display","position","onClose","aria-label","aria-hidden","SearchBar","stdin","msg","renderSuggestions","isTyping","autoSuggestions","suggestion","autoSuggestionCursor","onMouseEnter","keyboardInput","current","focusTextInput","updateAutoSuggest","inputString","typingFirstWord","split","length","currentWord","pop","matches","verbSuggestions","filter","includes","inputHistory","inputHistoryCursor","isFetchingSuggestion","bind","verb","focus","autoFocus","searchBarStyle","right","searchBarStyleTyping","onFocus","onBlur","onKeyDown","keyCode","placeholder","size","Composer","vfs","result","file_put_content","path","editor","icon","theme","editorProps","$blockScrolling","wsRoot","protocol","host","apiRoot","api_get_json","uri","fetch","method","accept","then","resp","getUUID","uuid","localStorage","getItem","d","Date","getTime","performance","now","replace","c","r","Math","random","floor","toString","generateUUID","setItem","socket","redStyle","color","Terminal","onMsg","image","Image","URL","createObjectURL","onAddOutputRow","startsWith","stdout","jsonObj","parseAPIResponse","onBroadcastEvent","composeCmd","args","renderOutputRow","phase","composerPhase","foregroundPid","disabled","locallyProcessed","OPEN","keyboardPressed","clickOnTerminal","document","getElementById","scrollToBottom","messagesEnd","scrollIntoView","behavior","prompt","promptInput","broadclient","BroadcastClient","output_rows","output_cursor_position","canvasStream","canvasStream2","concat","stderr","table","userInfo","quests","hint","initSocket","getElementsByClassName","scrollTo","offsetHeight","cmd_str","t","splice","composerState","stdinPromptString","onLoad","keyboardLoaded","autoComplete","backgroundColor","renderInputBar","el","hudStyle","marginRight","HUD","fname","cwd","xp","points","Video","srcObject","media","muted","autoPlay","playsInLine","defaultProps","signal_connection","rtcConn","optional","Camera","enteredRoom","signalConnected","videoOn","audioOn","flashMessage","error","myStream","room","isHost","remoteStreams","joinRoom","initiateRTCPeerConnection","ontrack","streams","tracklist","onicecandidateerror","message","onLoggedInWithSignalServer","usersCount","catch","channelJoined","onReceivedRemoteConnectionOffer","RTCSessionDescription","createAnswer","caller_id","onReceivedConnectionRequestResponse","sdp","onReceivedICECandidate","chatRoomChanged","audioCheckBoxChanged","videoCheckBoxChanged","gotMyStream","renderLobby","checked","renderRoom","remoteStream","onClosed","videoRef","MediaObject","renderVideo","renderText","text","renderImage","pictureUrl","renderCanvas","meter","fftSize","renderAudio","controls","mediaObject","streamType","divStyle","draggable","defaultDimensions","screenshare","webcam","picture","Broadcast","streamElements","additionalStreamParts","broadcasting","broadcastEvents","events","updateStreamElements","extra","cstate","broadcastClient","updateAdditionalStreamElements","parts","renderObjectives","renderPreview","part","controlClicked","control","turnOn","existingStream","ctx","player","createElement","createMediaStreamSource","connect","destination","streamFromCtx","createMediaStreamDestination","renderConsole","startBroadcasting","confirm","stopBroadcasting","renderControls","isOn","btnClass","renderHeader","href","previewDiv","BroadcastViewerClient","clientConnection","mediaObjectReady","remoteTracks","mediaObjectOffline","remoteTrackMetaData","hostId","showRemoteTracks","MediaStream","kind","ondatachannel","trackMetaData","watchChannel","gotSDP","Watch","_objs","renderStream","notDraggable","broadcastViewerClient","AppIconGrid","iconClicked","icons","index","col","iconStyle","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","borderColor","borderWidth","api_fs","mntType","fileMap","file_get_stream","ws","get_files","fileList","node","fullPath","file_get_meta","modificationTime","updated_at","file_get_content","response","body","upload_files","files","basePath","onMessage","_file","contentType","update","IMG_EXTS","chrome_fs","localFS","g_init_local_fs","requestFileSystem","PERSISTENT","_localFS","root","err","g_file_get_content","getFile","create","exclusive","entry","file","reader","FileReader","readType","onloadend","test","readAsDataURL","readAsText","g_file_put_contents","content","append","fileEntry","createWriter","writer","seek","blob","Blob","write","getDirEntriesSync","getDirectory","directory","createReader","readEntries","entries","g_list_local_files","nodes","edges","queue","root_node","parent","isDirectory","handleError","g_upload_file_sync","fsroot","fentry","g_upload_files","webkitRequestFileSystem","directoryEntry","webkitDirectoryEntry","ret","getMetadata","meta","filename","NODE_API_HOSTNAME","GREPAWK_STDIN","Vfs","upload_file_market","readAsArrayBuffer","close","api_post_json","cache","GFileListItem","fetchingMeta","that","fileMetaDescriptor","rowIndex","rowStyle","paddingLeft","faName","clickedDir","clickedFile","format","date","Finder","getFiles","get_full_path","basename","dirs","join","add_file","isComposing","composingTitle","composingContent","upload_to_vfs","_files","uploads","getFullBasePath","updateMessage","prompt_array","anwsers","q","previewFile","overflow","renderPreviewContent","class","isPublishing","fileBeingPublished","previewURL","previewContentType","objectFit","previewText","renderFileInfo","colspan","fs_type","fh","buffers","lineNumber","preview_content","dir","new_dirs","current_node_id","backDir","dirId","renderBreadCrumb","renderBody2","files_displayed","node_id","bottom","padding","isUploadingFiles","multiple","publishFile","responses","xpath","price","tags","info","composer","questionTypes","Desktop","renderSearchBar","processes","gold","pathname","search","API","_userInfo","setFiles","plist","proc","renderHud","renderBackground","renderQuestView","ReactDOM","render"],"mappings":"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","file":"static/js/main.e87a1c72.chunk.js","sourcesContent":["import React from 'react'\nimport './Window.css';\nimport Draggable from 'react-draggable'; // The default\n\nfunction debug(msg){\n //   document.getElementById(\"debug\").innerHTML+=\"<br>\"+msg;\n}\n\nclass Window extends React.Component{\n    constructor(props){\n        super(props);\n        this.state ={\n            minimized:false,\n            maximized:false,\n            closed:false,\n            isResizing:false,\n            isDragging: false,\n            top: props.top || 20,\n            left: props.left || 400,\n            width: props.width || 800, \n            height: props.height || 400,\n            lastMouseX: 0,\n            lastMouseY: 0\n        }\n    }\n    onNavBarClick=(e)=>{\n        const mode = e.target.className;\n        if(mode==='maximize'){\n            this.setState(prev=>({\n                maximized: !prev.maximized\n            }));\n        }else if(mode==='minimize'){\n            this.setState(prev=>({\n                minimized: !prev.minimized\n            }));\n        }else if(mode==='closee'){\n            this.setState({closed:true});\n            this.props.ipc(\"close\", [this.props.pid]);\n        }\n    }\n    renderNavTop=()=>{\n        return (\n        <div className='title' onMouseDown={this.onNavbarMouseDown}>\n            <button className='closee' onClick={this.onNavBarClick}>x</button>\n            <button className='maximize' onClick={this.onNavBarClick}>[]</button>\n            <button className='minimize' onClick={this.onNavBarClick}>_</button>\n            <p className='title'>{this.props.title}</p>\n        </div>\n        )\n    }\n\n\n    onNavbarMouseDown=(e)=>{\n        window.addEventListener(\"mousemove\",this.onNavbarMouseMove);\n        window.addEventListener(\"mouseup\", this.onNavbarMouseUp);\n        var mouseX=e.clientX;\n        var mouseY=e.clientY;\n        this.setState({\n            lastMouseX: mouseX,\n            lastMouseY: mouseY,\n            isDragging:   true\n        });\n    }\n    onNavbarMouseUp=(e)=>{\n        window.removeEventListener(\"mouseup\",this.onNavbarMouseUp);\n        window.removeEventListener(\"mousemove\",this.onNavbarMouseMove);\n\n    }\n    onNavbarMouseMove=(e)=>{\n        var mouseX=e.clientX;\n        var mouseY=e.clientY;\n        if(this.state.dragging===false) return;\n\n        const deltaX = mouseX - this.state.lastMouseX;\n        const deltaY = mouseY - this.state.lastMouseY;\n        this.setState({\n            left: this.state.left+deltaX,\n            top: this.state.top+deltaY,\n            lastMouseX: mouseX,\n            lastMouseY: mouseY,\n            maximized:  false,\n            minimized:  false,\n        })\n\n    }\n    onCornerMouseDown=(e)=>{\n        window.addEventListener(\"mousemove\",this.onCornerMouseMove);\n        window.addEventListener(\"mouseup\", this.onCornerMouseUp);\n        var mouseX=e.clientX;\n        var mouseY=e.clientY;\n        debug(\"mouse down\");\n        this.setState({\n            lastMouseX: mouseX,\n            lastMouseY: mouseY,\n            maximized:  false,\n            minimized:  false,\n            isResizing:   true\n        });\n    }\n    onCornerMouseUp=(e)=>{\n        this.setState({isResizing:false,lastMouseX:0, lastMouseY:0});\n        window.removeEventListener(\"mouseup\",this.onCornerMouseUp);\n        window.removeEventListener(\"mousemove\",this.onCornerMouseUp);\n    }\n\n    onCornerMouseMove=(e)=>{        \n        var mouseX=e.clientX;\n        var mouseY=e.clientY;\n        if(this.state.isResizing===false){\n            return;\n        }\n        debug(\"mouse move \"+mouseX+\" \"+mouseY);\n\n        const deltaX = mouseX - this.state.lastMouseX;\n        const deltaY = mouseY - this.state.lastMouseY;\n        this.setState({\n            width: this.state.width+deltaX,\n            height: this.state.height+deltaY,\n            lastMouseX: mouseX,\n            lastMouseY: mouseY\n        })\n    }\n    renderFooter=()=>{\n        return (\n            <div className=\"footer\" onMouseDown={this.onCornerMouseDown}>\n                <span>{this.props.windowInfo}</span>\n                <span className='corner' style={{float:\"right\"}}></span>\n            </div>\n        )\n    }\n\n    render(){\n        if(this.state.closed) return null;\n        var boxClass=\"box\";\n        if (this.props.className) \n            boxClass = this.props.className +\" \"+boxClass;\n\n        \n        const sizeStyle={\n            top:    this.state.maximized    ? 0      : this.state.top,\n            left:   this.state.maximized    ? 0      : this.state.left ,\n            width:  this.state.maximized    ? \"100%\" : this.state.width,\n            cursor: this.state.isResizing   ? \"se-resize\" : \"cursor\",\n            height: this.state.minimized    ? 18     : this.state.maximized ? \"100%\" : this.state.height,\n            zIndex: 10\n        }\n\n        const corderStyle={\n            cursor: 'se-resize',\n            float:\"right\"\n        }\n\n        return (\n            <div className={boxClass} style={sizeStyle}>\n                {this.renderNavTop()}\n                <div className='body'>\n                  {this.props.children}\n\n                </div>\n                <div className=\"footer\" onMouseDown={this.onCornerMouseDown}>\n                        <span>{this.props.windowInfo}</span>\n                        <span className='corner' style={corderStyle}></span>\n                </div>\n          </div>\n       ) \n    }\n}\n\nexport default Window;","import React from 'react';\nvar HtmlToReactParser = require('html-to-react').Parser;\n\nclass Table extends React.Component{\n    constructor(props){\n        super(props);\n    }\n    renderHeaders=()=>{\n        if(!this.props.headers) return null;\n        return (\n            <thead>\n                <tr key={'tbtrh1'}>    \n                {this.props.headers.map((header,i)=>{\n                    return (<th key={\"th\"+i}>{header}</th>)\n                })}\n                </tr>\n            \n            </thead>\n        )\n    }\n\n    renderLink=(cmd, desc)=>{\n        return (\n            <span ref={React.createRef()}\n                className='terminal-link' \n                onClick={()=>{this.props.clickedCmd(cmd)}}>\n                {desc}\n            </span>\n        )\n    }\n    renderBody=()=>{\n        if(!this.props.rows) return null;\n        return (\n            <tbody>\n            {this.props.rows.map((row)=>{\n                return this.renderTableRow(row);\n             })}\n            </tbody>\n        )\n    }\n\n    render(){\n        return(\n        <table className={this.props.className || \"table\"} border=\"1\">\n            {this.renderHeaders()}\n            {this.renderBody()}\n        </table>\n        )\n    }\n    renderTableRow=(row)=>{\n        return (\n            <tr>{\n                this.props.headers.map((header)=>{\n                    var val = row[header] || \"\";\n                    if (header == \"opts\") {\n                        var opt = val[0];\n                        return (<td>{this.renderLink(opt.cmd, opt.desc)}</td>)\n                    }else if (header === 'thumbnail') {\n                        var img_url = val;\n                        return (<td><img width={120} src={img_url} /></td>)\n                    } else {\n                        return (<td>{val}</td>)\n                    }\n                })\n            }</tr>\n        )\n    }\n}\n\nexport default Table;","import React from 'react';\nclass ListView extends React.Component{\n    render(){\n        return (\n            <div className={this.props.className}>\n                <h5>{this.props.title}</h5>\n                <ul>\n                    {this.props.list && this.props.list.map ? this.props.list.map((item, i) => {\n                        return (\n                            <li key={\"list-\" + i}>\n                                <h5 className=\"list-header\">{item.title}</h5>\n                                <div className=\"list-body\">{item.description}</div>\n                            </li>\n                        )\n                    }):null}\n                </ul>\n            </div>\n        )\n    }\n}\n\nexport default ListView;","import React from 'react'\nimport ListView from '../components/ListView';\n\nclass GFileSelector extends React.Component{\n    constructor(props){\n        super(props);\n        this.state={\n            files_selected: [],\n            status: \"new\"\n        }\n    }\n    componentDidMount=()=>{\n\n    }\n    renderFileSelectedList=()=>{\n        return (\n            <ListView headers={['name','size','type']} rows={this.state.files_selected}>\n            </ListView>\n        )\n    }\n    renderControlPanel=()=>{\n        return this.state.status==='new' ?\n        (\n            <div className='ctrl-panel'>\n                <button className='btn btn-secondary' onClick={this.onCancel}>Cancel</button>\n                <button className='btn btn-primary' onClick={this.onSave}> Save</button>\n            </div>\n        ) : (\n            <div></div>\n        )  \n    }\n    onFileChange=(e)=>{\n\n    }\n    onSave =(e)=>{\n        \n    }\n    onCancel=(e)=>{\n        alert(\"cancel\");\n    }\n\n    render(){\n        return(\n            <div className='anchor'>\n                <input type=\"file\" \n                    className=\"form-control\" \n                    id=\"file-select-input\" \n                    name=\"file\"\n                    onChange={this.props.onFilesChange || this.onFileChange} />\n            {this.renderFileSelectedList()}\n            {this.renderControlPanel()}\n        </div>\n        )\n    }\n}\nexport default GFileSelector;","const peerRTCConfig = {\n  RTCIceServers: [\n    { url: \"stun:stun01.sipphone.com\" },\n    { url: \"stun:stun.ekiga.net\" },\n    { url: \"stun:stun.fwdnet.net\" },\n    { url: \"stun:stun.ideasip.com\" },\n    { url: \"stun:stun.iptel.org\" },\n    { url: \"stun:stun.rixtelecom.se\" },\n    { url: \"stun:stun.schlund.de\" },\n    { url: \"stun:stun.l.google.com:19302\" },\n    { url: \"stun:stun1.l.google.com:19302\" },\n    { url: \"stun:stun2.l.google.com:19302\" },\n    { url: \"stun:stun3.l.google.com:19302\" },\n    { url: \"stun:stun4.l.google.com:19302\" },\n    { url: \"stun:stunserver.org\" },\n    { url: \"stun:stun.softjoys.com\" },\n    { url: \"stun:stun.voiparound.com\" },\n    { url: \"stun:stun.voipbuster.com\" },\n    { url: \"stun:stun.voipstunt.com\" },\n    { url: \"stun:stun.voxgratia.org\" },\n    { url: \"stun:stun.xten.com\" },\n    {\n      url: \"turn:numb.viagenie.ca\",\n      credential: \"muazkh\",\n      username: \"webrtc@live.com\",\n    },\n    {\n      url: \"turn:192.158.29.39:3478?transport=udp\",\n      credential: \"JZEOEt2V3Qb0y27GRntt2u2PAYA=\",\n      username: \"28224511:1379330808\",\n    },\n    {\n      url: \"turn:192.158.29.39:3478?transport=tcp\",\n      credential: \"JZEOEt2V3Qb0y27GRntt2u2PAYA=\",\n      username: \"28224511:1379330808\",\n    },\n  ],\n};\n\nconst signalServerURL = window.location.origin + \"/ice\";\n\nfunction BroadcasterClient(config) {\n  config = config || {};\n  config.console = config.console || \"console\";\n  const hostname = config.hostname || signalServerURL;\n  let onEvent = config.onEvent || console.log;\n  let signalConnection;\n  let peerConnections = {};\n  let localTracks = [];\n  var host_uuid;\n  var audioCtx = new AudioContext();\n  var audioMeter = audioCtx.createAnalyser();\n\n  var audioMeterBuffer = new Uint8Array(256);\n\n  function trackDescriptor(id, track, dimensions) {\n    return {\n      id: id,\n      track: track,\n      dimensions: dimensions,\n      live: true,\n    };\n  }\n  function addTrack(track, dimensions) {\n    for (var idx in localTracks) {\n      if (localTracks[idx].id === track.id) {\n        localTracks[idx] = trackDescriptor(track.id, track, dimensions);\n      }\n    }\n    localTracks.push(trackDescriptor(track.id, track, dimensions));\n  }\n  function removeTrack(track) {\n    for (var idx in localTracks) {\n      if (localTracks[idx].id === track.id) {\n        localTracks[idx].live = false;\n      }\n    }\n  }\n  function sendJson(json, to_uuid) {\n    if (to_uuid) json[to_uuid] = to_uuid;\n    signalConnection.send(JSON.stringify(json));\n  }\n\n  function startBroadcast(channelName) {\n    signalConnection = new WebSocket(hostname);\n    signalConnection.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      onEvent(event.data.type || \"\");\n      switch (data.type) {\n        case \"registered\":\n          host_uuid = data.host_uuid;\n          break;\n        case \"user_joined\":\n          user_join_request(data);\n          break;\n        case \"answer\":\n          user_sent_sdp_answser(data);\n          break;\n        case \"candidate\":\n          user_sent_peer_ice_candidate(data);\n          break;\n        case \"user_left\":\n          break;\n        default:\n          break;\n      }\n    };\n    signalConnection.onopen = (e) => {\n      sendJson({\n        type: \"register_stream\",\n        channel: channelName,\n      });\n      onEvent(\"Stream registered \" + channelName);\n    };\n    signalConnection.onerror = (e) =>\n      onEvent(\"ERROR: signalconnection not connecting\", e);\n  }\n\n  function user_sent_peer_ice_candidate(data) {\n    if (!data.client_uuid || !data.candidate)\n      throw new Error(\"unexpected request in user_sent_peer_ice_candidate\");\n    peerConnections[data.client_uuid].addIceCandidate(data.candidate);\n    onEvent(\"add peer ice candidate from \" + data.client_uuid);\n  }\n\n  function user_sent_sdp_answser(data) {\n    if (!data.client_uuid || !data.answer)\n      throw new Error(\"unexpected request in user_sent_peer_ice_candidate\");\n    peerConnections[data.client_uuid].set_sdp_anwser(data.answer);\n  }\n\n  function user_join_request(data) {\n    if (!data.client_uuid) throw new Error(\"unexpected user_join request\");\n    peerConnections[data.client_uuid] = BroadcasterRTCConnection(\n      signalConnection,\n      data.client_uuid,\n      host_uuid,\n      onEvent\n    );\n    peerConnections[data.client_uuid].updateTracks(localTracks);\n  }\n  function updateTrackForPeers() {\n    Object.values(peerConnections).forEach((client) => {\n      client.updateTracks(localTracks);\n    });\n  }\n\n  function addStream(stream, dimensions) {\n    stream.getTracks().forEach((track) => {\n      addTrack(track, dimensions);\n    });\n    updateTrackForPeers();\n  }\n\n  function removeStream(stream) {\n    stream.getTracks().forEach((track) => {\n      removeTrack(track);\n      track.stop();\n    });\n    updateTrackForPeers();\n    return null;\n  }\n\n  function requestUserStream(type) {\n    return new Promise(async (resolve, reject) => {\n      try {\n        let stream;\n        if (type == \"screenshare\") {\n          stream = await navigator.mediaDevices.getDisplayMedia();\n        } else if (type == \"webcam\") {\n          stream = await navigator.mediaDevices.getUserMedia({\n            video: true,\n            audio: false,\n          });\n        } else if (type == \"audio\") {\n          stream = await navigator.mediaDevices.getUserMedia({\n            video: false,\n            audio: true,\n          });\n        } else {\n          reject(new Error(\"Unkown type\"));\n        }\n        if (stream) resolve(stream);\n        else resolve(null);\n      } catch (e) {\n        reject(e);\n      }\n    });\n  }\n\n  return {\n    requestUserStream: requestUserStream,\n    addStream: addStream,\n    removeStream: removeStream,\n    peerConnections: peerConnections,\n    startBroadcast: startBroadcast,\n    audioMeter: audioMeter,\n    audioCtx: audioCtx,\n  };\n}\nfunction BroadcasterRTCConnection(\n  signalConnection,\n  client_uuid,\n  host_uuid,\n  onEvent\n) {\n  var signalConnection = signalConnection;\n  var client_uuid = client_uuid;\n  var host_uuid;\n  var peerConnection = new RTCPeerConnection(peerRTCConfig);\n  var metadataChannel = peerConnection.createDataChannel(\"metadata\");\n\n  var trackMap = {};\n\n  metadataChannel.onopen = function () {\n    onEvent(\"Meta channel open with \" + client_uuid);\n    sendMetaData();\n  };\n  peerConnection.onicecandidate = (e) => {\n    if (e.candidate) {\n      signalConnection.send(\n        JSON.stringify({\n          type: \"candidate\",\n          candidate: e.candidate,\n          to_uuid: client_uuid,\n          host_uuid: host_uuid,\n        })\n      );\n    }\n  };\n  peerConnection.onnegotiationneeded = async (evt) => {\n    onEvent(\"creating sdp offer for \" + client_uuid);\n    const offer = await peerConnection.createOffer();\n    await peerConnection.setLocalDescription(offer);\n    signalConnection.send(\n      JSON.stringify({\n        type: \"offer\",\n        to_uuid: client_uuid,\n        offer: offer,\n        host_uuid: host_uuid,\n      })\n    );\n  };\n  function sendMetaData() {\n    if (!metadataChannel || metadataChannel.readyState !== \"open\") {\n      onEvent(\"metadata channel not yet o0pen\");\n      setTimeout(sendMetaData, 1000);\n      return;\n    }\n\n    let metadata = [];\n    let trackIds = Object.keys(trackMap);\n    trackIds.forEach((trackId) => {\n      let track = trackMap[trackId];\n      metadata.push({\n        trackId: track.id,\n        dimensions: track.dimensions,\n        live: track.active,\n      });\n    });\n    let payload = {\n      type: \"mediaMetadata\",\n      data: metadata,\n    };\n    onEvent(\"sending metadata \", payload);\n    metadataChannel.send(JSON.stringify(payload));\n  }\n\n  return {\n    updateTracks: function (tracks) {\n      for (var idx in tracks) {\n        let trackId = tracks[idx].id;\n        if (typeof trackMap[trackId] !== \"undefined\") {\n          continue;\n        }\n        trackMap[trackId] = tracks[idx];\n        if (tracks[idx].live) peerConnection.addTrack(tracks[idx].track);\n      }\n      sendMetaData();\n    },\n\n    set_sdp_anwser: async function (answer) {\n      try {\n        await peerConnection.setRemoteDescription(answer);\n        onEvent(\"Remote Anwser set\");\n      } catch (e) {\n        onEvent(\"ERROR: in set_dsp_anwser\");\n      }\n    },\n    addIceCandidate: function (candidate) {\n      onEvent(\"add ice candidate \");\n      peerConnection.addIceCandidate(candidate);\n    },\n  };\n}\n\n//\nexport default BroadcasterClient;\n","import React from \"react\";\n\nclass Modal extends React.Component{\n    constructor(props){\n        super(props);\n        this.state={\n            answers: this.props.initialAnswers || {}\n        }\n    }\n    componentDidMount(){\n        if(this.props.initialAnswers && this.props.questions){\n            var setState={};\n            this.props.questions.forEach((question,i)=>{\n                setState[question] = this.props.initialAnswers[i];\n            })\n            this.setState(setState);\n        }\n    }\n\n    render(){\n        const modalStyle = this.props.style || {\n            display:  'block',\n            position: 'fixed',\n            width: '50vw',\n            height: '80vh',\n            top: '5vh',\n            left: '25vw'\n        }\n        return (\n            <div style={modalStyle} className=\"modal-content\">\n              <div className=\"modal-header\">\n                <h5 className=\"modal-title\">{this.props.title}</h5>\n                <button type=\"button\" className=\"close\" onClick={this.props.onClose} aria-label=\"Close\">\n                  <span aria-hidden=\"true\">&times;</span>\n                </button>\n              </div>\n              <div className=\"modal-body\">\n                <p>{this.props.children || this.renderBody()}</p>\n              </div>\n              <div className=\"modal-footer\">\n                <button type=\"button\" className=\"btn btn-secondary\" onClick={this.props.onClose}>Cancel</button>\n                <button type=\"button\" className=\"btn btn-primary\" onClick={this.props.onSave || this.clickedSave}>Publish</button>\n              </div>\n            </div>\n        )\n    }\n    clickedSave=()=>{\n        this.props.onSubmit(this.state.answers);\n       \n    }\n    renderBody=()=>{\n        const stateAnwsers = this.state.answers;\n        return (\n        <div>\n        {\n            this.props.questions.map((question,idx)=>{\n                let val = stateAnwsers[question] || \"\";\n                return (\n                    <div className='form-group form-row'>\n                        <label className=\"col-md-6\" for={\"`input-${idx}`\"}>{question}</label>\n                        <input \n                            className=\"col-md-6\" \n                            value={val} \n                            onChange={(e)=>{\n                                const name = e.target.name;\n                                const value = e.target.value;\n                                stateAnwsers[name]=value;\n                                this.setState({answers: stateAnwsers})\n                            }}\n                            type='text' \n                            name={question} \n                            ref={'question '+idx}></input>\n                    </div>\n                )\n            })\n        }\n        </div>)\n\n    }\n\n}\n\nexport default Modal;","import React from \"react\";\nclass SearchBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      inputHistory: [],\n      inputHistoryCursor: 0,\n      isTyping: false,\n      isFetchingSuggestion: false,\n      autoSuggestions: [],\n      autoSuggestionCursor: 0,\n    };\n    this.keyboardInput = React.createRef();\n    this.focusTextInput = this.focusTextInput.bind(this);\n    this.verbSuggestions = (props.verbSuggestions &&\n      this.props.verbSuggestions.map((verb) => {\n        return {\n          cmd: verb,\n          description: verb,\n        };\n      })) || [\n      {\n        cmd: \"search\",\n        description: \"disocver files and file content\",\n      },\n      {\n        cmd: \"compose\",\n        description: \"create content\",\n      },\n      {\n        cmd: \"request\",\n        description: \"request document, script, or live consulting\",\n      },\n      {\n        cmd: \"neighbors\",\n        description: \"visit a neighbor and discover their content\",\n      },\n      {\n        cmd: \"radio\",\n        description: \"listen to radio\",\n      },\n      {\n        cmd: \"share\",\n        description: \"share security peer-to-peer\",\n      },\n      {\n        cmd: \"broadcast\",\n        description: \"live stream\",\n      },\n      {\n        cmd: \"connect\",\n        description: \"with people or IP addresses\",\n      },\n    ];\n  }\n\n  focusTextInput() {\n    this.keyboardInput.current.focus();\n  }\n\n  componentDidMount() {\n    if (this.props.autoFocus) {\n      this.focusTextInput();\n    }\n    this.updateAutoSuggest();\n  }\n\n  stdin = (msg) => {\n    alert(msg);\n  };\n\n  renderSuggestions = () => {\n    if (this.state.isTyping === false) return null;\n\n    return (\n      <ul className=\"list-group suggestions\">\n        {this.state.autoSuggestions.map((suggestion, idx) => {\n          const className =\n            idx === this.state.autoSuggestionCursor\n              ? \"list-group-item active\"\n              : \"list-group-item\";\n          return (\n            <li\n              className={className}\n              onMouseEnter={(e) => {\n                this.setState({ autoSuggestionCursor: idx });\n              }}\n              onClick={(e) => {\n                this.keyboardInput.current.value = suggestion.cmd + \" \";\n                this.focusTextInput();\n              }}\n            >\n              <b>{suggestion.cmd}</b>: {suggestion.description}\n            </li>\n          );\n        })}\n      </ul>\n    );\n  };\n\n  updateAutoSuggest = (inputString) => {\n    var typingFirstWord = !inputString || inputString.split(\" \").length < 2;\n    var typingSecondWord =\n      !typingFirstWord && inputString.split(\" \").length < 2;\n    var currentWord = (inputString && inputString.split(\" \").pop()) || \"\";\n\n    if (typingFirstWord) {\n      var matches = this.verbSuggestions.filter((suggestion) => {\n        return !currentWord || suggestion.cmd.includes(currentWord);\n      });\n\n      this.setState({ autoSuggestions: matches });\n    }\n  };\n\n  render() {\n    const searchBarStyle = this.props.searchBarStyle || {\n      position: \"fixed\",\n      right: 150,\n      top: 160,\n      zIndex: -10,\n    };\n\n    const searchBarStyleTyping = this.props.searchBarStyleTyping || {\n      position: \"fixed\",\n      right: 150,\n      top: 40,\n      zIndex: \"1 !important\",\n    };\n\n    return (\n      <div\n        className=\"md-col-6\"\n        style={\n          this.state.isTyping === false ? searchBarStyle : searchBarStyleTyping\n        }\n      >\n        <input\n          ref={this.keyboardInput}\n          onClick={this.focusTextInput}\n          onFocus={() => {\n            this.setState({ isTyping: true });\n          }}\n          onBlur={() => {\n            // this.setState({isTyping:false});\n          }}\n          onKeyDown={(e) => {\n            if (e.keyCode == 13) {\n              //enter\n              this.stdin(e.target.value);\n              e.target.value = \"\";\n            } else if (e.keyCode == 9) {\n              //tab\n              this.setState({\n                autoSuggestionCursor: this.state.autoSuggestionCursor + 1,\n              });\n              // if(this.state.autoSuggestions[this.state.autoSuggestionCursor] &&\n              //     this.state.autoSuggestions[this.state.autoSuggestionCursor].cmd){\n              //     e.target.value=this.state.autoSuggestions[this.state.autoSuggestionCursor].cmd+\" \";\n              // }\n            } else if (e.keyCode == 32) {\n              //space bar\n              this.updateAutoSuggest(e.target.value);\n            } else if (e.keyCode === 27) {\n              //escape\n              this.setState({\n                isTyping: false,\n              });\n            } else {\n              this.updateAutoSuggest(e.target.value);\n            }\n          }}\n          placeholder={\n            this.state.isTyping ? \"type query\" : \"are you feeling lucky?\"\n          }\n          className=\"form-control\"\n          type=\"text\"\n          size={this.props.size || 80}\n        />\n\n        {this.renderSuggestions()}\n      </div>\n    );\n  }\n}\nexport default SearchBar;\n","import React from \"react\";\nimport Modal from \"../components/Modal\";\nimport AceEditor from \"react-ace\";\nimport Window from \"../components/Window\";\nimport SearchBar from \"../SearchBar\";\n\nclass Composer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.editor = React.createRef();\n    //this.focusEditor = ()=>this.editor.props.onFocus();\n  }\n  componentDidMount() {\n    // this.focusEditor();\n  }\n  onSave = () => {\n    alert(this.props.value);\n    if (this.props.vfs) {\n      let result = this.props.vfs.file_put_content(\n        this.props.path,\n        this.props.value\n      );\n      alert(result);\n    }\n  };\n  render() {\n    return (\n      <Window\n        width={1000}\n        height={600}\n        left={220}\n        ipc={this.props.ipc}\n        icon=\"computer\"\n        title={this.props.title}\n      >\n        <AceEditor\n          mode=\"java\"\n          theme=\"github\"\n          onChange={() => {}}\n          name=\"UNIQUE_ID_OF_DIV\"\n          editorProps={{ $blockScrolling: true }}\n        />\n      </Window>\n    );\n  }\n}\nexport default Composer;\n","export const wsRoot = `${\n  window.location.protocol == \"https:\" ? \"wss\" : \"ws\"\n}://${window.location.host}`;\n\nexport const apiRoot = window.location.origin;\n\nexport const signalWs = `${wsRoot}/ice`;\n","import { apiRoot } from \"./constants\";\nvar API = {};\n\nexport function api_post_json(uri, data) {\n  return fetch(`${apiRoot}${uri}`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    cache: \"no-cache\",\n    body: JSON.stringify(data),\n  }).then((resp) => resp.json());\n}\n\nexport function api_get_json(uri) {\n  return fetch(`${apiRoot}${uri}`, {\n    method: \"GET\",\n    headers: { accept: \"application/json\" },\n  }).then((resp) => resp.json());\n}\nexport function generateUUID() {\n  // Public Domain/MIT\n  var d = new Date().getTime();\n  if (\n    typeof performance !== \"undefined\" &&\n    typeof performance.now === \"function\"\n  ) {\n    d += performance.now(); //use high-precision timer if available\n  }\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n    var r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c === \"x\" ? r : (r & 0x3) | 0x8).toString(16);\n  });\n}\nexport function getUUID() {\n  var uuid = localStorage.getItem(\"uuid\");\n  if (uuid && uuid !== \"undefined\") return uuid;\n  uuid = generateUUID();\n  localStorage.setItem(\"uuid\", uuid);\n}\n","import React from \"react\";\nimport Window from \"./components/Window\";\nimport \"./Terminal.css\";\nimport Table from \"./components/Table\";\nimport GFileSelector from \"./FileExplorer/GFileSelector\";\nimport BroadcastClient from \"./Broadcast/BroadcastClient\";\nimport Composer from \"./FileExplorer/Composer\";\nimport { wsRoot } from \"./constants\";\nimport { useChannel } from \"./useChannel\";\nimport { getUUID } from \"./APICalls\";\nlet socket = null;\n\nconst redStyle = { color: \"red\" };\n\nclass Terminal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.prompt = React.createRef();\n    this.promptInput = React.createRef();\n    this.broadclient = BroadcastClient({\n      onEvent: this.onBroadcastEvent,\n      console: \"stdin2\",\n    });\n    this.state = {\n      socket,\n      output_rows: [],\n      output_cursor_position: 0,\n      uuid: getUUID(),\n      canvasStream: null,\n      canvasStream2: null,\n      foregroundPid: null,\n      composerPhase: \"root\",\n    };\n    this.onMsg.bind(this);\n    this.parseAPIResponse.bind(this);\n  }\n\n  initSocket() {\n    this.onAddOutputRow({ type: \"text\", data: \"Init..\" + wsRoot });\n    socket = new WebSocket(wsRoot);\n    socket.onopen = (e) => {\n      this.onAddOutputRow({ type: \"text\", data: \"CONNECTED\" });\n      socket.onmessage = this.onMsg;\n      socket.send(\"check-in \" + this.state.uuid);\n    };\n  }\n  onMsg = (e) => {\n    if (!e.data) return;\n    if (typeof e.data === \"object\") {\n      var image = new Image();\n      image.src = URL.createObjectURL(e.data);\n      this.onAddOutputRow({ type: \"image\", data: image });\n    } else if (e.data.startsWith(\"stdout: \")) {\n      var stdout = e.data.replace(\"stdout: \", \"\");\n      this.onAddOutputRow({ type: \"text\", data: stdout });\n    } else if (e.data.startsWith(\"stderr: \")) {\n      var stdout = e.data.replace(\"stderr: \", \"\");\n      this.onAddOutputRow({ type: \"text\", data: stdout });\n    } else {\n      try {\n        const jsonObj = JSON.parse(e.data);\n        this.parseAPIResponse(jsonObj);\n      } catch (e) {\n        this.onAddOutputRow({ type: \"text\", data: stdout });\n      }\n    }\n  };\n  onAddOutputRow(row) {\n    const list = this.state.output_rows.concat(row);\n    this.setState({ output_rows: list });\n  }\n\n  parseAPIResponse(data) {\n    if (data.stdout) {\n      this.onAddOutputRow({ type: \"text\", data: data.stdout });\n    }\n    if (data.stderr) {\n      this.onAddOutputRow({ type: \"text\", data: data.stderr });\n    }\n    if (data.table) {\n      this.onAddOutputRow({ type: \"table\", data: data.table });\n    }\n    if (data.userInfo) {\n      // this.onAddOutputRow({type:\"text\",data: JSON.stringify(data)})\n      localStorage.setItem(\"uuid\", data.userInfo.uuid);\n      this.props.ipc(\"hud-update\", data.userInfo);\n    }\n    if (data.quests) {\n      this.props.ipc(\"questlist\", data.quests);\n    }\n    if (data.hint) {\n      //todo\n    }\n  }\n\n  componentDidMount() {\n    this.initSocket();\n  }\n\n  onBroadcastEvent = (evt) => {\n    alert(evt);\n  };\n  composeCmd = (cmd, args) => {};\n\n  renderOutputRow = (row, i) => {\n    switch (row.type) {\n      case \"compose\":\n        return (\n          <Composer\n            title=\"Compose Tracks\"\n            phase={this.state.composerPhase}\n            ipc={this.composeCmd}\n          ></Composer>\n        );\n      case \"stdout\":\n      case \"text\":\n        return <pre key={\"op-\" + i}>{row.data}</pre>;\n      case \"stderr\":\n        return (\n          <pre key={\"op-\" + i}>\n            <span style={redStyle}>{row.data}</span>\n          </pre>\n        );\n      case \"stdin\":\n        return (\n          <div className=\"input-line\" key={\"op-\" + i}>\n            <div className=\"prompt\">{this.state.foregroundPid}></div>\n            <input className=\"cmdline input-line\" disabled value={row.cmd} />\n          </div>\n        );\n      case \"table\":\n        return (\n          <div key={\"op-\" + i}>\n            <Table\n              clickedCmd={this.stdin}\n              className=\"table table-dark\"\n              headers={row.data.headers}\n              rows={row.data.rows}\n            ></Table>\n          </div>\n        );\n      case \"imageLink\":\n        return (\n          <div key={\"op-\" + i}>\n            <img src={row.data}></img>\n          </div>\n        );\n      case \"filelink\":\n        return (\n          <div key={\"op-\" + i}>\n            <iframe src={row.data}></iframe>\n          </div>\n        );\n      case \"upload\":\n        return <GFileSelector></GFileSelector>;\n        break;\n      default:\n        break;\n    }\n  };\n  keyboardLoaded(e) {\n    e.target.focus();\n  }\n  windowLoaded(e) {\n    document.getElementsByClassName(\"terminal-body\").scrollTo(0, 100);\n    e.target.offsetHeight = 1000;\n  }\n\n  locallyProcessed(cmd_str) {\n    if (!cmd_str) return false;\n\n    var t = cmd_str.split(\" \");\n    const cmd = t[0];\n    const args = t.splice(1);\n    if (this.state.foregroundPid === \"compose\") {\n      this.setState({\n        composerState: cmd,\n      });\n      return true;\n    }\n    switch (cmd) {\n      case \"compose\":\n        this.setState({ foregroundPid: \"compose\" });\n        break;\n      case \"upload\":\n      case \"openimage\":\n        this.onAddOutputRow({ type: cmd, data: args[0] });\n        return true;\n      case \"edit\":\n        this.props.ipc(cmd, args);\n        return true;\n      case \"cam\":\n      case \"new\":\n      case \"stream\":\n      case \"broadcast\":\n      case \"draw\":\n      case \"watch\":\n        this.props.ipc(cmd, args);\n        return true;\n      default:\n        return false;\n    }\n  }\n  stdin = (cmd) => {\n    this.onAddOutputRow({ type: \"stdin\", cmd });\n    if (!this.locallyProcessed(cmd)) {\n      if (socket.readyState !== WebSocket.OPEN) {\n        this.onAddOutputRow({ type: \"stderr\", data: \"Not connected\" });\n      } else {\n        socket.send(cmd);\n      }\n    }\n  };\n\n  keyboardPressed = (e) => {\n    if (e.keyCode == 13) {\n      //enter\n      this.stdin(e.target.value);\n      e.target.value = \"\";\n    }\n  };\n\n  renderInputBar() {\n    const stdinPromptString = this.state.foregroundPid || \"\";\n    return (\n      <div className=\"input-line\">\n        <div id=\"stdin-prompt\" className=\"prompt\">\n          {stdinPromptString}>{\" \"}\n        </div>\n        <input\n          autoFocus={true}\n          onLoad={this.keyboardLoaded}\n          onKeyDown={this.keyboardPressed}\n          size=\"80\"\n          id=\"terminal_input\"\n          autoComplete=\"off\"\n          className=\"cmdline input-line\"\n        />\n      </div>\n    );\n  }\n\n  clickOnTerminal = (e) => {\n    document.getElementById(\"terminal_input\").focus();\n  };\n\n  render() {\n    const fontStyle = {\n      color: \"white\",\n      backgroundColor: \"black\",\n    };\n    return (\n      <Window\n        className=\"terminal\"\n        title={this.props.title}\n        pid={this.props.pid}\n        ipc={this.props.ipc}\n      >\n        <div\n          style={fontStyle}\n          className=\"terminal-body\"\n          onClick={this.clickOnTerminal}\n        >\n          {this.state.output_rows.map((row, i) => {\n            return this.renderOutputRow(row, i);\n          })}\n          {this.renderInputBar()}\n          <div\n            className=\"terminal-anchor\"\n            ref={(el) => {\n              this.messagesEnd = el;\n            }}\n          >\n            {\" \"}\n          </div>\n        </div>\n      </Window>\n    );\n  }\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n  scrollToBottom = () => {\n    this.messagesEnd.scrollIntoView({ behavior: \"smooth\" });\n  };\n}\n\nexport default Terminal;\n","import React from 'react'\nconst hudStyle={\n  float:'right',\n  marginRight:\"15px\",\n  height:\"20px\",          \n}\nclass HUD extends React.Component{\n    constructor(props){\n        super(props)\n    }\n    \n    render(){\n        return(\n            <span style={hudStyle} className=\"HUD\">\n                Name: {this.props.fname || this.props.username || \"guest\"}, \n                Location: {this.props.cwd ||\"root\"},\n                XP Level:{this.props.xp || 0}, \n                Gold:{this.props.points||0}\n            </span>\n        )\n    }\n}\n\nexport default HUD;","import PropTypes from 'prop-types';\nimport React from 'react';\n\nclass Video extends React.Component {\n  componentDidMount() {\n    this.video.srcObject = this.props.media;\n  }\n\n  shouldComponentUpdate(props) {\n    return this.props.media !== props.media;\n  }\n\n  componentDidUpdate() {\n    this.video.srcObject = this.props.media;\n  }\n\n  render() {\n    const { width, height, muted, children } = this.props;\n\n    return (\n      <video\n        height={height}\n        width={width}\n        muted={muted}\n        autoPlay\n        playsInLine\n        ref={(video) => { this.video = video; }}\n      >\n        {children}\n      </video>\n    );\n  }\n}\n\nVideo.defaultProps = {\n  children: null,\n  height: 420,\n  width: 640,\n  muted: true,\n  media: null,\n};\n\nVideo.propTypes = {\n  children: PropTypes.element,\n  media: PropTypes.shape(\n    {\n      active: PropTypes.bool,\n      ended: PropTypes.bool,\n      id: PropTypes.string,\n    },\n  ),\n  muted: PropTypes.bool,\n};\n\nexport default Video;\n","import React from 'react'\nimport Window from './components/Window'\nimport Video from \"./Video\";\n\nconst lobbyStyle={\n\n}\n\nconst signal_url=\"ws://localhost:9090\";\nvar signal_connection, rtcConn;\n\n\nconst peerRTCConfig = {\n    'RTCIceServers': [{\n          'url': 'stun:stun.l.google.com:19302'\n       },\n       {\n          'url': 'turn:192.158.29.39:3478?transport=udp',\n          'credential': 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\n          'username': '28224511:1379330808'\n       },\n       {\n          'url': 'turn:192.158.29.39:3478?transport=tcp',\n          'credential': 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\n          'username': '28224511:1379330808'\n       }\n    ],\n    optional: [{\n       'DtlsSrtpKeyAgreement': true\n    }]\n\n }\n\n \nclass Camera extends React.Component{\n    constructor(props){\n        super(props);\n        this.videoRef = React.createRef();\n    }\n    state={\n        enteredRoom: false,\n        signalConnected:false,\n        videoOn:true,\n        audioOn: true,\n        flashMessage:\"\",\n        error:null,\n        myStream: null,\n        room: this.props.room || \"default\",\n        isHost:null,\n        remoteStreams:[]\n    }\n\n    async componentDidMount(){\n        signal_connection = new WebSocket(signal_url);\n        signal_connection.onopen=(e)=>{\n            this.setState({signalConnected:true});\n        };\n        signal_connection.onmessage=(msg)=>{\n            try{\n                var data = JSON.parse(msg.data);\n                console.log(\"signal on msg \", msg);\n                if (data.type === 'login') {\n                    this.onLoggedInWithSignalServer(data);\n                }\n                else if (data.type === 'offer') {\n                    debugger;\n                    if(data.offer.sdp){\n                        this.onReceivedRemoteConnectionOffer(data);\n\n                    }else{\n                        console.log(\"signal ret offer not contrain sdp\", data);\n                    }\n                }\n                else if (data.type === 'answer') {\n                    this.onReceivedConnectionRequestResponse(data);\n                }\n                else if(data.type==='candidate'){\n                    this.onReceivedICECandidate(data);\n                }else if(data.type==='error'){\n                    debugger;\n                    this.setState({flashMessage:data.message});\n                }\n    \n\n            }catch(e){\n                console.log(\"signal onmsg failed\", e);\n            }\n          \n        }\n       try{\n        var myStream = await navigator.mediaDevices.getDisplayMedia();\n        this.setState({myStream:myStream});\n       }catch(e){\n           this.setState({error:e.message});\n       }\n \n\n    }\n    componentWillUnmount(){\n        this.onClosed();\n    }\n\n    joinRoom=async()=>{\n        this.setState({enteredRoom:true});\n        signal_connection.send(JSON.stringify({ type: 'login', channel: this.state.room, uuid: this.props.userInfo.uuid }));\n    }\n\n    initiateRTCPeerConnection=()=>{\n        rtcConn = new RTCPeerConnection(peerRTCConfig);\n\n        rtcConn.ontrack=(e)=>{\n            if(e.streams && e.streams[0]){\n                const tracklist = this.state.remoteStreams.concat(e.streams[0]);\n                this.setState({remoteStreams:tracklist});\n            }\n        }\n        rtcConn.onicecandidateerror=(e)=>{\n            this.setState({flashMessage:e.message});\n        }\n        rtcConn.onicecandidate = (event)=>{\n            if (event.candidate!=null) {\n                signal_connection.send(JSON.stringify({\n                  type: \"candidate\",\n                  candidate: event.candidate,\n                  channel:this.state.room\n               }))\n            }\n         }\n         return  rtcConn;\n    }\n\n    onLoggedInWithSignalServer=(data)=>{\n        this.setState({signalConnected:true});\n        if(data.usersCount==1){\n            this.setState({flashMessage:\"Joined channel \"+data.channelJoined+\". Only you here.\"});\n            return;\n        }\n        this.initiateRTCPeerConnection();\n\n        rtcConn.onnegotiationneeded = (e)=>{\n            rtcConn.createOffer().then(desc=>{\n                rtcConn.setLocalDescription(desc);\n                signal_connection.send(JSON.stringify({\n                    type: 'offer',\n                    offer: desc,\n                    channel: this.state.room\n                 }));\n            }).catch(e=>{\n                debugger;\n                alert(e.message);\n            })\n           \n        }\n        this.state.myStream.getTracks(track=>{\n            rtcConn.addTrack(track,this.state.myStream);\n        })\n\n        rtcConn.createOffer().then(desc=>{\n            rtcConn.setLocalDescription(desc);\n            signal_connection.send(JSON.stringify({\n                type: 'offer',\n                offer: desc,\n                channel: this.state.room\n             }));\n        }).catch(e=>{\n            alert(e.message);\n        })\n    }\n\n    onReceivedRemoteConnectionOffer=(data)=>{\n         this.initiateRTCPeerConnection();\n        rtcConn.setRemoteDescription(new RTCSessionDescription(data.offer)).then(() => {\n                this.state.myStream.getTracks().forEach(track=>{\n                    rtcConn.addTrack(track,this.state.myStream);\n                })\n            }).then(()=>{\n                return rtcConn.createAnswer();\n            }).then((answer)=>{\n                rtcConn.setLocalDescription(answer);\n                return answer;\n            }).then((answer)=>{\n                signal_connection.send(JSON.stringify({\n                    type: 'answer',\n                    answer: answer,\n                    channel: data.channel,\n                    uuid: data.caller_id\n                }));\n            }).catch(e=>{\n                console.log(e);\n                this.setState({flashMessage:e.message+\" on receive remote errored\"});\n            })\n    }\n\n    onReceivedConnectionRequestResponse=(data)=>{\n        if(data.answer.sdp){\n\n            rtcConn.setRemoteDescription(data.answer).then(function(){\n                return navigator.mediaDevices.getDisplayMedia();\n            }).then((stream)=>{\n                stream.getTracks().forEach(track=>rtcConn.addTrack(track,stream));\n            })    \n         }\n    }\n    onReceivedICECandidate=(data)=>{\n        rtcConn.addIceCandidate(data.candidate).catch(e => {\n            console.log(\"Failure during addIceCandidate(): \" + e.name);\n        });\n    }\n    chatRoomChanged=(e)=>{\n        const value = e.target.value;\n        this.setState({'room':value});\n    }\n    audioCheckBoxChanged=(e)=>{\n        this.setState({'audioOn':e.target.value});\n    }\n    videoCheckBoxChanged=(e)=>{\n        this.setState({'videoOn':e.target.value});\n    }\n\n    gotMyStream=(stream)=>{\n        this.setState({'myStream':stream});\n    }\n    renderLobby=()=>{      \n        return (\n            <div className='cam-lobby'>\n                <p>{this.state.flashMessage}</p>\n                <Video width={300} media={this.state.myStream}></Video>\n                <p>Join Room: <input   id='join_room_name' onChange={this.chatRoomChanged} value={this.state.room} type='text' size='50'></input></p>\n                <p>Audio: <input id='join_room_audio' onChange={this.audioCheckBoxChanged} type='checkbox' checked /></p>\n                <p>Video: <input id='join_room_video'  onChange={this.videoCheckBoxChanged} type='checkbox' checked /></p>\n                <p><button onClick={this.joinRoom}>Go</button> </p>\n            </div>\n        )\n    }\n    renderRoom=()=>{\n        return (<div className='cam-room'>\n            <h3>Room {this.state.room}</h3> \n                <p>{this.state.flashMessage}</p>\n                <Video key=\"mstream\" width={200} height={100}  media={this.state.myStream}></Video>\n                {this.state.remoteStreams.map((remoteStream,i)=>{\n                    console.log(remoteStream);\n                    return ( <Video key={\"remote-stream-\"+i} width={100} height={100} media={remoteStream}></Video>)\n                })}            \n        </div>)\n    }\n    render(){\n        return (<Window className=\"camera\" title={this.props.title} pid={this.props.pid} ipc={this.props.ipc}>\n            {this.state.error!==null ? <div>Error: {this.state.error}</div>: \n                (this.state.signalConnected==false || this.state.myStream ==null) ? <div>Connecting..</div> : \n                   this.state.enteredRoom==false ? this.renderLobby() : this.renderRoom()}\n        </Window>)\n    }\n    onClosed=()=>{\n        //this.state.myStream.stop();\n    }\n\n}\nexport default Camera;","import React from \"react\";\nimport Video from \"../Video\";\nclass MediaObject extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dimensions: props.mediaObject[2],\n    };\n  }\n\n  renderVideo = (stream) => {\n    return <Video width={\"100%\"} height={\"100%\"} media={stream}></Video>;\n  };\n\n  renderText = (text) => {\n    return <div>{text}</div>;\n  };\n  renderImage = (pictureUrl) => {\n    return <img src={pictureUrl}></img>;\n  };\n\n  renderCanvas = (meter) => {\n    let arraybuffer = new Uint8Array(meter.fftSize);\n    return null;\n    // return (\n    //   <AnimatedCanvas\n    //     updateCanvasData={function () {\n    //       meter.getByteFrequencyData(arraybuffer);\n    //       return arraybuffer;\n    //     }}\n    //     draw={function (ctx, width, height, data) {\n    //       ctx.fillStyle = \"black\";\n    //       ctx.fillRect(0, 0, width, height);\n    //       var x = 0;\n    //       for (let i = 0; i < data.length; i++) {\n    //         const barheight = data[i] * 10;\n    //         const barWidth = 3;\n    //         ctx.fillStyle = `rbga(${barheight},50,50,0.8)`;\n    //         ctx.fillRect(x, 0, barWidth, barheight);\n    //         x += barWidth;\n    //       }\n    //     }}\n    //   ></AnimatedCanvas>\n  };\n\n  renderAudio = (stream) => {\n    return (\n      <audio\n        width={\"100%\"}\n        height={\"100%\"}\n        srcObject={stream}\n        muted={false}\n        autoPlay={true}\n        controls\n      ></audio>\n    );\n  };\n  render() {\n    const streamType = this.props.mediaObject[0];\n    const stream = this.props.mediaObject[1];\n    const dimensions = this.state.dimensions;\n    const extras = this.props.mediaObject[3];\n    const divStyle = {\n      position: \"absolute\",\n      left: dimensions[0] + \"%\",\n      top: dimensions[1] + \"%\",\n      width: dimensions[2] + \"%\",\n      height: dimensions[3] + \"%\",\n    };\n\n    return (\n      <div draggable style={divStyle}>\n        {streamType == \"video\" ? this.renderVideo(stream) : null}\n        {streamType == \"screenshare\" ? this.renderVideo(stream) : null}\n        {streamType == \"webcam\" ? this.renderVideo(stream) : null}\n        {streamType == \"audioMeter\" ? this.renderCanvas(stream) : null}\n\n        {streamType == \"audio\" ? this.renderAudio(stream) : null}\n        {streamType == \"text\" ? this.renderText(stream) : null}\n        {streamType == \"image\" ? this.renderImage(stream) : null}\n      </div>\n    );\n  }\n}\n\nexport default MediaObject;\n","import React from \"react\";\nimport Window from \"../components/Window\";\nimport MediaObject from \"./MediaObject\";\nimport './broadcast.css';\nimport BroadcastClient from \"./BroadcastClient\";\n\nconst streamHost = \"https://grepawk.com/watch/\";\nconst defaultDimensions ={\n    screenshare: [0,0,100,100],\n    webcam: [80, 80, 20,20],\n    audio: [70, 0,30,10],\n    text:[5,5,80, 10],\n    picture:[0, 10, 20,20],\n    audioMeter: [0,0, 20,20]\n}\n\nclass Broadcast extends React.Component {\n  state = {\n    screenshare: false,\n    webcam: false,\n    audio: false,\n    streamElements:{},\n    additionalStreamParts: [],\n    broadcasting: false,\n    broadcastEvents:[],\n  };\n\n  constructor(props){\n      super(props);\n      this.broadcastClient = BroadcastClient({\n          onEvent: this.onBroadcastEvent,\n          console: \"console\"\n      })\n      this.channelName = this.props.args[0];\n  }\n  onBroadcastEvent = (event)=>{\n      let events = this.state.broadcastEvents;\n      events.push(event);\n      this.setState({broadcastEvents:events});\n  }\n\n  updateStreamElements=(type, mediaObject, dimensions,extra)=>{\n    let cstate = this.state.streamElements;\n    cstate[type]=[type, mediaObject, dimensions,extra];\n    \n    if(mediaObject!==null && this.state.broadcasting===true){\n        this.broadcastClient.addStream(mediaObject, dimensions);\n        this.onBroadcastEvent(\"Adding stream \"+type);\n    }\n    this.setState({streamElements:cstate});\n  }\n\n  updateAdditionalStreamElements=(type,mediaObject,dimensions)=>{\n    let parts = this.state.additionalStreamParts;\n    parts.push([type, mediaObject,dimensions]);\n    this.setState({additionalStreamParts:parts});\n    if(mediaObject!==null && this.state.broadcasting===true){\n        this.broadcastClient.addStream(mediaObject, dimensions);\n        this.onBroadcastEvent(\"Adding stream \"+type);\n    }else{\n        // this.onBroadcastEvent(\"failed adding stream \"+type);\n\n    }\n  }\n\n  renderObjectives = () =>{\n\n  }\n  renderPreview = () =>{\n      const parts = Object.keys(this.state.streamElements);\n      return (\n            <div>\n            {parts.map(part=>{return (\n                <MediaObject mediaObject={this.state.streamElements[part]}></MediaObject>)})\n             }   \n             {this.state.additionalStreamParts.map(part=>{\n                 return (\n                     <MediaObject mediaObject={part}></MediaObject>\n                 )\n             })}\n            </div>         \n      )\n  }\n\n  controlClicked=async (control)=>{\n      let turnOn = !this.state[control];\n\n      let existingStream = (this.state.streamElements[control] && this.state.streamElements[control][1]) || null; \n      let stream, player;\n      const ctx =  this.broadcastClient.audioCtx;\n      player = document.createElement(\"audio\");\n      player.controls = true;\n      player.muted = true;\n      switch(control){\n          case \"screenshare\":\n                stream = turnOn ? await this.broadcastClient.requestUserStream(control) \n                                    : await this.broadcastClient.removeStream(existingStream);\n                this.updateStreamElements(control, stream, defaultDimensions[control]);\n                this.setState({screenshare: turnOn});\n                break;\n          case \"webcam\":\n                stream = turnOn ? await this.broadcastClient.requestUserStream(control) \n                                    : await this.broadcastClient.removeStream(existingStream);\n                                    \n                this.updateStreamElements(control, stream, defaultDimensions[control]);\n                this.setState({webcam:turnOn});\n                break;\n           case \"audio\":\n                stream = turnOn ? await this.broadcastClient.requestUserStream(control) \n                                    : await this.broadcastClient.removeStream(existingStream);\n\n\n                this.setState({audio:turnOn});\n\n                player.srcObject=stream;\n\n                var node = ctx.createMediaStreamSource(stream);\n                node.connect(this.broadcastClient.audioMeter).connect(ctx.destination);\n                var streamFromCtx = ctx.createMediaStreamDestination().stream;\n                this.updateStreamElements(control, streamFromCtx, defaultDimensions[control]);\n\n                this.updateAdditionalStreamElements(\"audioMeter\", this.broadcastClient.audioMeter, defaultDimensions['audioMeter']);\n\n                this.setState({audio:turnOn});\n                break;\n            case 'text':\n                var text=prompt(\"Enter Text\");\n                this.updateAdditionalStreamElements(\"text\", text, defaultDimensions[control]);\n                break;\n            case 'picture':\n                var pictureUrl=prompt(\"Enter Picture URL\");\n                this.updateAdditionalStreamElements(\"text\", pictureUrl, defaultDimensions[control]);\n                break;\n            default: break;\n      }\n  }\n  renderConsole = () =>{\n      return (\n          <div>\n              {this.state.broadcastEvents.map(event=>{\n                  let msg;\n                  if(typeof event===\"object\"){\n                      msg=JSON.stringify(event);\n                  }else{\n                     msg = event;\n                  }\n                  return (<p>{msg}</p>)\n              })}\n          </div>\n      )\n\n  }\n\n  startBroadcasting = async ()=>{\n      if(!this.channelName){\n        this.channelName=prompt(\"What channel name do you want?\");\n      }\n      if(!this.channelName){\n          return;\n      }\n     var r = window.confirm(\"Start broadcasting at https://www.grepawk.com/watch/\"+this.channelName+\" now?\");\n\n    if(r){\n        this.broadcastClient.startBroadcast(this.channelName);\n        Object.values(this.state.streamElements).forEach((streamElements)=>{\n            if(streamElements[1]!==null){\n                this.broadcastClient.addStream(streamElements[1],streamElements[2]);\n            }\n        })\n        this.setState({broadcasting:true});\n     }\n\n  }\n  stopBroadcasting = ()=>{\n    this.setState({broadcasting:false});\n  }\n\n  renderControls = () => {\n    return (\n        <ul className=\"list-group controls\"> \n            {\n                [\"screenshare\",\"webcam\",\"audio\",\"picture\",\"text\"].map(control=>{\n                    var isOn = this.state[control];\n                    var text = isOn ? control+\" off\" : control;\n                    var btnClass = isOn ? \"btn btn-secondary\" : \"btn btn-primary\";\n                    return(\n                        <li className=\"list-group-item\">\n                            <button className={btnClass} onClick={()=>{this.controlClicked(control)}}>{text}</button>\n                        </li>\n                    )\n                })\n            }\n                            \n        </ul>\n    );\n  };\n\n  renderHeader=()=>{\n      return(\n        <div className='header'>\n                {this.state.broadcasting === false\n                ? <a href='javascript://' onClick={this.startBroadcasting}>Start Broadcast  </a>\n                : <a href='javascript://' onClick={this.stopBroadcasting} >Stop Broadcast</a>}\n           \n        </div>\n      )\n  }\n  render() {\n    return (\n      <Window  width={900} height={700} left={120}\n        className=\"stream\"\n        title={this.props.title}\n        pid={this.props.pid}\n        ipc={this.props.ipc}\n        draggable={false}\n      >\n        {this.state.flashMessage ? <div>{this.state.flashMessage}</div> : null}\n        <div className=\"obs\">\n            {this.renderHeader()}\n                \n            {this.renderControls()}\n            <div className='preview' ref={this.previewDiv}>\n                {this.renderPreview()}\n            </div>\n            <div className=\"console\">{this.renderConsole()}</div>\n          <div className=\"objectives\">{this.renderObjectives()}</div>\n        </div>\n      </Window>\n    );\n  }\n}\nexport default Broadcast;\n","const signalServerURL = window.location.hostname == 'localhost' ? \"ws://localhost:9091\" : \"wss://grepawk.com/signal\";\nconst peerRTCConfig = {\n    'RTCIceServers': [{url:'stun:stun01.sipphone.com'},\n    {url:'stun:stun.ekiga.net'},\n    {url:'stun:stun.fwdnet.net'},\n    {url:'stun:stun.ideasip.com'},\n    {url:'stun:stun.iptel.org'},\n    {url:'stun:stun.rixtelecom.se'},\n    {url:'stun:stun.schlund.de'},\n    {url:'stun:stun.l.google.com:19302'},\n    {url:'stun:stun1.l.google.com:19302'},\n    {url:'stun:stun2.l.google.com:19302'},\n    {url:'stun:stun3.l.google.com:19302'},\n    {url:'stun:stun4.l.google.com:19302'},\n    {url:'stun:stunserver.org'},\n    {url:'stun:stun.softjoys.com'},\n    {url:'stun:stun.voiparound.com'},\n    {url:'stun:stun.voipbuster.com'},\n    {url:'stun:stun.voipstunt.com'},\n    {url:'stun:stun.voxgratia.org'},\n    {url:'stun:stun.xten.com'},\n    {\n        url: 'turn:numb.viagenie.ca',\n        credential: 'muazkh',\n        username: 'webrtc@live.com'\n    },\n    {\n        url: 'turn:192.158.29.39:3478?transport=udp',\n        credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\n        username: '28224511:1379330808'\n    },\n    {\n        url: 'turn:192.158.29.39:3478?transport=tcp',\n        credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\n        username: '28224511:1379330808'\n        }]\n}\n\n\nfunction BroadcastViewerClient(config){\n    const hostname = config.hostname || signalServerURL;\n    let onEvent = config.onEvent || console.log;\n    let mediaObjectReady = config.mediaObjectReady;\n    let mediaObjectOffline = config.mediaObjectOffline;\n    let signalConnection;\n    let clientConnection;\n    let remoteTracks={};\n    let remoteTrackMetaData={};\n    let metadataChannel;\n    let host_uuid;\n\n\n    function watchChannel(channelName){\n        signalConnection = new WebSocket(hostname);\n        signalConnection.onopen = function (e) {\n            signalConnection.send(JSON.stringify({\n                type: \"watch_stream\",\n                channel: channelName\n            }))\n\n            signalConnection.onmessage = function (event) {\n                let data = JSON.parse(event.data);\n                onEvent(\"Signal Server msg type \"+data.type);\n                switch (data.type) {\n                    case 'offer':\n                        onEvent(\"got offer: host_uuid=\", data.host_uuid);\n                        gotSDP(data.offer, data.host_uuid);\n                        break;\n                    case 'candidate':\n                        onEvent(\"got candidate\");\n                        clientConnection.addIceCandidate(data.candidate);\n                        break;\n\n                    case 'error':\n                        onEvent(\"Error: \"+data.message);\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n    }\n\n    \n    async function gotSDP(offer, hostId) {\n        host_uuid = hostId;\n        clientConnection = new RTCPeerConnection(peerRTCConfig);\n        clientConnection.ondatachannel=function(evt){\n            evt.channel.onopen=()=>onEvent(\"metadata channel on client open\");\n            evt.channel.onmessage=(e)=>{\n                onEvent(\"got metadata \"+e.data);\n                let data = JSON.parse(e.data);\n                if(data.type=='mediaMetadata'){\n                    let mediaDescriptors = data.data;\n                    mediaDescriptors.forEach(trackMetaData=>{\n                      let trackId =   trackMetaData.trackId;\n                      remoteTrackMetaData[trackId]=trackMetaData;\n                    });\n                }\n                showRemoteTracks();\n            }\n        }\n\n        function showRemoteTracks(){\n            onEvent(\"showing remote tracks: \"+Object.keys(remoteTrackMetaData).length);\n            for(let trackId in remoteTrackMetaData){\n                let metadata = remoteTrackMetaData[trackId];\n                if(remoteTracks[trackId]){\n                    let stream = new MediaStream();\n                    stream.addTrack(remoteTracks[trackId]);\n                    mediaObjectReady(trackId, stream,remoteTracks[trackId].kind, metadata.dimensions);\n                    onEvent(\"showing tracking \");\n                }else{\n                    // let stream = new MediaStream();\n                    // stream.addTrack(remoteTracks[trackId]);\n                    // mediaObjectReady(trackId, stream,remoteTracks[trackId].kind, metadata.dimensions);\n                    // onEvent(\"showing tracking \");\n\n                    onEvent(\"Got meta data but not track\")\n                }\n\n            }\n        }\n        \n        clientConnection.onicecandidate = (e) => {\n            onEvent(\"client on ice candidate \", e);\n            if (e.candidate) {\n                signalConnection.send(JSON.stringify({\n                    type: \"candidate\",\n                    to_uuid: host_uuid,\n                    candidate: e.candidate\n                }))\n            }\n        }\n\n        clientConnection.ontrack = (e) => {\n            if(e.track){\n                remoteTracks[e.track.id]=e.track;\n            }\n            showRemoteTracks();\n        }\n\n        await clientConnection.setRemoteDescription(new RTCSessionDescription(offer));\n        const answer = await clientConnection.createAnswer();\n        clientConnection.setLocalDescription(answer);\n        signalConnection.send(JSON.stringify({\n            type: \"answer\",\n            to_uuid: host_uuid,\n            answer: answer\n        }))\n    }\n    return {\n        watchChannel: watchChannel\n    }\n}\n\nexport default BroadcastViewerClient;\n","import React from \"react\";\nimport Window from \"../components/Window\";\nimport MediaObject from \"./MediaObject\";\nimport BroadcastViewerClient from \"./BroadcastViewerClient\";\nimport \"./Watch.css\";\n\nclass Watch extends React.Component {\n    state={\n        broadcastEvents:[],\n        media:{}\n    }\n\n    constructor(props){\n        super(props);\n        this.broadcastViewerClient = BroadcastViewerClient({\n            channelName:        this.props.channelName,\n            onEvent:            this.onBroadcastEvent,\n            mediaObjectReady:   this.mediaObjectReady,\n            mediaObjectOffline: this.mediaObjectReady\n        });\n    }\n\n    mediaObjectReady=(trackId, stream, type, dimensions)=>{\n       let _objs = this.state.media;\n       _objs[trackId] = [type, stream, dimensions];   \n       this.setState({media: _objs});\n    }\n\n    mediaObjectOffline=(trackId)=>{\n        let _objs = this.state.media;\n        delete _objs[trackId];\n        this.setState({media: _objs});\n    }\n\n  onBroadcastEvent = (event)=>{\n      let events = this.state.broadcastEvents;\n      events.push(event);\n      this.setState({broadcastEvents:events});\n  }\n\n  componentDidMount() {\n      this.broadcastViewerClient.watchChannel(this.props.channelName);\n  }\n\n  renderStream = () =>{\n      const parts = Object.keys(this.state.media);\n     console.log(\"Rendering \"+parts.length+\" stream parts\");\n      return (\n            <div className='stream-content'>\n                {\n                   parts.map((part,idx)=>{ \n                        return (<MediaObject key={idx} notDraggable={true} \n                                mediaObject={this.state.media[part]}></MediaObject>)\n                    })\n                }   \n            </div>         \n      )\n  }\n\n\n  renderConsole = () =>{\n      return (\n          <div className='console-watcher'>\n              {this.state.broadcastEvents.map((event,idx)=>{\n                  let msg;\n                  if(typeof event===\"object\"){\n                      msg=JSON.stringify(event);\n                  }else{\n                     msg = event;\n                  }\n                  return (<p key={idx}>{msg}</p>)\n              })}\n          </div>\n      )\n\n  }\n  render() {\n    return (\n      <Window\n        top={20}\n        left={60}\n        width={1200}\n        height={600}\n        className=\"watch-stream\"\n        title={this.props.title}\n        pid={this.props.pid}\n        ipc={this.props.ipc}\n        draggable={false}   \n      >\n      <div key='rr' className='stream-wrapper'>\n        {this.renderStream()}\n        {this.renderConsole()}\n      </div>\n      </Window>\n    );\n  }\n}\nexport default Watch;\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport \"./AppIconGrid.css\";\n\nconst icons_per_column = 5;\n\nclass AppIconGrid extends React.Component {\n  constructor(props) {\n    super(props);\n    this.iconClicked = this.iconClicked.bind(this);\n  }\n\n  iconClicked(idx) {\n    var icon = this.props.icons[idx];\n    this.props.ipc(icon.cmd, icon.args);\n  }\n  render() {\n    return (\n      <div className=\"app-icon-grid\">\n        {this.props.icons.map((icon, index) => {\n          const row = index % icons_per_column;\n          const col = Math.floor(index / icons_per_column);\n          const iconStyle = {\n            gridColumnStart: col,\n            gridColumnEnd: col + 1,\n            gridRowStart: row,\n            gridRowEnd: row + 1,\n            width: 50,\n            height: 50,\n            borderColor: \"black\",\n            borderWidth: 2,\n            // backgroundColor:\"#D3D3D3\"\n          };\n\n          return (\n            <div\n              key={\"icon\" + index}\n              style={iconStyle}\n              onClick={() => {\n                this.iconClicked(index);\n              }}\n            >\n              <i className={\"fas fa-lg fa-\" + icon.name}></i>\n              <br></br>\n              {icon.title}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nexport default AppIconGrid;\n","import { api_get_json } from \"../APICalls\";\n\nvar api_fs = function (mntType) {\n  var fileMap = {};\n  var mntType = mntType || \"azure\";\n\n  return {\n    file_get_stream: async function (path) {\n      return new Promise((resolve, reject) => {\n        var ws = new WebSocket(\"/\" + path);\n        ws.onopen = (e) => {\n          resolve(ws);\n        };\n        ws.onerror = reject;\n      });\n    },\n    get_files: async function () {\n      let fileList = await api_get_json(`/file/${mntType}/list`);\n      fileList[0].forEach((node) => {\n        fileMap[node.fullPath] = node;\n      });\n      return fileList;\n    },\n    file_get_meta: function (fullPath, stdout) {\n      if (fileMap[fullPath]) {\n        stdout({\n          size: fileMap[fullPath].size || 0,\n          type: fileMap[fullPath].type || \"file\",\n          modificationTime:\n            (fileMap[fullPath].updated_at &&\n              new Date(fileMap[fullPath].updated_at)) ||\n            null,\n        });\n      } else {\n        stdout(null);\n        throw new Error(\"File not registered\");\n      }\n    },\n    file_get_content: function (path) {\n      return new Promise((resolve, reject) => {\n        fetch(path)\n          .then((response) => {\n            resolve({\n              type: \"text\",\n              payload: response.body(),\n            });\n          })\n          .catch(reject);\n      });\n    },\n    upload_files: async function (files, basePath, onMessage) {\n      for (let i = 0; i < files.length; i++) {\n        const _file = files[0];\n        let url = \"/upload?basepath=\" + basePath;\n        fetch(url, {\n          body: _file,\n          method: \"POST\",\n          headers: {\n            contentType: _file.type,\n            \"x-file-name\": _file.name,\n            \"x-file-size\": _file.size,\n          },\n        })\n          .then(async function readResponse(response) {\n            let update = await response.text();\n            console.log(update);\n            if (onMessage) onMessage(update);\n          })\n          .catch((e) => {\n            alert(e.message);\n          });\n      }\n    },\n  };\n};\n\nexport default api_fs;\n","import { apiRoot } from \"../constants\";\nconst IMG_EXTS = /\\.(gif|jpg|jpeg|tiff|png)$/i;\nconst VIDEO_EXTS = /\\.(mov|mp4|m4a|ogg)$/i;\nconst NODE_API_HOSTNAME = apiRoot;\n\nvar chrome_fs = function () {\n  window.requestFileSystem =\n    window.requestFileSystem || window.webkitRequestFileSystem;\n  window.directoryEntry = window.directoryEntry || window.webkitDirectoryEntry;\n  var localFS;\n  function g_init_local_fs() {\n    return new Promise((resolve, reject) => {\n      window.requestFileSystem(\n        window.PERSISTENT,\n        100 * 1024 * 1024,\n        function (_localFS) {\n          localFS = _localFS.root;\n          resolve(localFS);\n        },\n        function (err) {\n          reject(new Error(\"error requesting local fs\"));\n        }\n      );\n    });\n  }\n\n  function g_file_get_content(path) {\n    return new Promise(async (resolve, reject) => {\n      if (!localFS) localFS = await g_init_local_fs();\n      localFS.getFile(\n        path,\n        { create: false, exclusive: false },\n        function (entry) {\n          entry.file(function (file) {\n            var _file = file;\n            var reader = new FileReader();\n            var readType = \"text\";\n            reader.onloadend = function (e) {\n              resolve({ type: readType, payload: this.result, file: _file });\n            };\n            reader.onerror = function (e) {\n              reject(new Error(\"reader failed\"));\n            };\n            if (IMG_EXTS.test(file.name)) {\n              readType = \"image\";\n              reader.readAsDataURL(file);\n            } else {\n              reader.readAsText(file);\n            }\n          });\n        },\n        function (e) {\n          reject(e);\n        }\n      );\n    });\n  }\n\n  function g_file_put_contents(path, content, append = true) {\n    return new Promise(async (resolve, reject) => {\n      if (!localFS) localFS = await g_init_local_fs();\n      localFS.getFile(\n        path,\n        { create: true, exclusive: true },\n        (fileEntry) => {\n          if (content) {\n            fileEntry.createWriter(function (writer) {\n              if (append) {\n                writer.seek(writer.length);\n              }\n              var blob = new Blob([content], { type: \"text/plain\" });\n              writer.write(blob);\n              resolve(fileEntry);\n            });\n          } else {\n            resolve(fileEntry);\n          }\n        },\n        reject\n      );\n    });\n  }\n\n  function getDirEntriesSync(path) {\n    return new Promise(async (resolve, reject) => {\n      let fsroot = await g_init_local_fs();\n      fsroot.getDirectory(\n        path,\n        { create: false },\n        function (directory) {\n          directory.createReader().readEntries(function (entries) {\n            resolve(entries);\n          });\n        },\n        reject\n      );\n    });\n  }\n  function g_list_local_files(path) {\n    return new Promise(async (resolve, reject) => {\n      let root_node = {\n        name: path,\n        fullPath: \"\",\n        id: 0,\n      };\n      let queue = [];\n      let nodes = [];\n      let edges = [];\n      queue.push(root_node);\n      nodes.push(root_node);\n      edges[0] = [];\n      let parent;\n      while (queue.length > 0) {\n        parent = queue.pop();\n        parent.id = parent.id || 0;\n        let entries = await getDirEntriesSync(parent.name);\n        entries.forEach(async (entry) => {\n          entry.id = nodes.length;\n          nodes.push(entry);\n          edges[parent.id] = edges[parent.id] || [];\n          edges[parent.id].push(entry.id);\n          if (entry.isDirectory) {\n            queue.push(entry);\n          }\n        });\n      }\n      resolve([nodes, edges]);\n    });\n  }\n\n  function handleError(e) {\n    alert(e.message);\n  }\n\n  function g_upload_file_sync(fsroot, file) {\n    return new Promise((resolve, reject) => {\n      fsroot.getFile(\n        file.fullPath,\n        { create: true, exclusive: false },\n        (fentry) => {\n          fentry.createWriter(function (writer) {\n            writer.write(file);\n            resolve();\n          }, handleError);\n        },\n        handleError\n      );\n    });\n  }\n  function g_upload_files(files) {\n    return new Promise(async (resolve, reject) => {\n      let fsroot = await g_init_local_fs();\n      for (let i = 0; i < files.length; i++) {\n        await g_upload_file_sync(fsroot, files[i]);\n      }\n      resolve();\n    });\n  }\n\n  return {\n    get_files: async function (path) {\n      try {\n        var ret = await g_list_local_files(path);\n        return ret;\n      } catch (err) {\n        return null;\n      }\n    },\n    file_get_meta: function (fullPath, stdout) {\n      try {\n        g_init_local_fs().then((fsroot) => {\n          fsroot.getFile(fullPath, {}, function (fileEntry) {\n            fileEntry.getMetadata(\n              (meta) => {\n                stdout({\n                  size: meta.size || 0,\n                  modificationTime: meta.modificationTime,\n                });\n              },\n              function (err) {\n                stdout(\"error: \" + err.message);\n              }\n            );\n          });\n        });\n      } catch (err) {\n        // alert(err.message);\n        stdout(\"error \" + err.message);\n      }\n    },\n    file_put_content: async function (filename, content) {\n      try {\n        return await g_file_put_contents(filename, content, true);\n      } catch (err) {\n        alert(err.message);\n      }\n    },\n    upload_files: async function (files) {\n      try {\n        await g_upload_files(files);\n      } catch (e) {\n        throw e;\n      }\n    },\n    file_get_content: async function (path) {\n      try {\n        var content = await g_file_get_content(path);\n        return content;\n      } catch (e) {\n        throw e;\n      }\n    },\n  };\n};\nexport default chrome_fs;\n","import api_fs from \"./APIFileSystem\";\nimport chrome_fs from \"./ChromeFileSystem\";\nconst NODE_API_HOSTNAME =  window.location.hostname === \"localhost\" ? \"http://localhost\" : \"https://grepawk.com\";\nconst GREPAWK_STDIN =  window.location.hostname === \"localhost\" ? \"WS://localhost:8086\" : \"https://grepawk.com/stdin\";\n\nvar Vfs = function(type){\n  if(type=='chrome')      return chrome_fs();\n  else if(type=='azure')  return api_fs(\"azure\");\n  else if(type=='market') return api_fs(\"market\");\n}\n\nVfs.upload_file_market= async function(file){\n  return new Promise((resolve,reject)=>{\n    let socket = new WebSocket(GREPAWK_STDIN);\n    socket.onopen=(e)=>{\n      socket.send(\"#pathname: azure/market/\"+file.name);\n      socket.send(\"#size: \"+file.size);\n      socket.send(\"#contentType \"+file.type);\n      var reader = new FileReader();\n      reader.onloadend=(e)=>{\n        socket.send(this.result);\n        socket.send(\"EOF\");\n      }\n      reader.readAsArrayBuffer(file);\n      socket.onmessage=(e)=>{\n        var msg = e.data;\n        if(msg.toString().startsWith(\"URL: \")){\n          socket.close();\n          resolve(msg.replace(\"URL: \",\"\"));\n        }\n        else if(msg.toString().startsWith(\"ERROR: \")){\n          socket.close();\n          reject(new Error(msg.replace(\"ERROR: \",\"\")));\n        }\n      }\n    }\n  \n  })\n};\n\n\nVfs.api_post_json=function(uri, data){\n  return new Promise((resolve,reject)=>{\n    var url = NODE_API_HOSTNAME+\"/api\"+uri;\n    fetch(url,{\n      method:\"POST\",\n      headers:{\n        'Content-Type':\"application/json\"\n      },\n      cache:\"no-cache\",\n      body: JSON.stringify(data)\n    }).then(resp=>resp.json()).then(resolve).catch(reject);\n  })\n}\n\nexport default Vfs;\n\n\n// var v = Vfs();\n// v.get_files(\"/chrome\");\n","import React from 'react';\n\nimport Moment from 'react-moment';\n\nclass GFileListItem extends React.Component{\n\n    constructor(props){\n        super(props);\n        this.state={\n            fileMetaDescriptor: {},\n        }\n        this.fetchingMeta = false;\n    }\n\n    componentDidMount=()=>{\n        if(this.props.vfs && this.fetchingMeta===false){\n            this.fetchingMeta = true;\n            var that = this;\n            this.props.vfs.file_get_meta(this.props.file.fullPath, function(meta){\n                if(meta!==null && meta!== that.state.fileMetaDescriptor){\n                    that.setState({fileMetaDescriptor: meta});\n                }\n                that.fetchingMeta = false;\n            });\n        }\n    }\n\n    render(){\n        const rowIndex = this.props.rowIndex;\n        const file = this.props.file;\n        const sizeStr = this.state.fileMetaDescriptor.size || \"0\";\n        const typeStr = this.state.fileMetaDescriptor.type || file.isDirectory ? \"dir\" : \"file\";\n        var rowStyle = {\n            paddingLeft:\"5px\",\n            color: \"#D7D7D7\",\n            backgroundColor: rowIndex % 2 ===0 ? \"#2A2A2A\" : \"#242424\",\n            height:\"50px\",\n            position:\"relative\"\n        }\n        var spanOne={\n            position:\"absolute\",\n            top: 2,\n            left: 2,\n            width: 20,\n            height: 48\n        }\n        var spanTwo={\n            position:\"absolute\",\n            top: 2,\n            left: 25,\n            width: 100,\n            height: 48\n        }\n        var spanThree={\n            position:\"absolute\",\n            top: 2,\n            left: 170,\n            width: 200,\n            height: 48\n        }\n        var spanFour={\n            position:\"absolute\",\n            top: 2,\n            right: 5,\n            width: 100,\n            height: 48\n        }\n\n\n        const faName = file.isDirectory === true ? \"fa-folder\" : \"fa-file\";\n        return (\n            <div style={rowStyle} onClick={()=>{\n                if(!file.isDirectory){\n                    this.props.clickedFile(file)\n                }else{\n                    this.props.clickedDir(file);\n                }\n              }}>\n                  <div>\n                    <span style={spanOne}>\n                        <i className={\"fas fa-lg \"+faName}> </i>  \n                   </span>\n                   <span style={spanTwo}>{file.name}</span>\n                    {/* <span style={spanThree}>{sizeStr}</span> */}\n                    <span style={spanFour}>\n                        {this.state.fileMetaDescriptor.modificationTime ? \n                            <Moment\n                                format=\"YYYY/MM/DD\" \n                                date={this.state.fileMetaDescriptor.modificationTime}\n                            />\n                            :null}\n                    </span>\n                </div>\n                <div>\n                    \n                </div>\n           </div>\n\n        )\n    }\n}\nexport default GFileListItem;","import React, { useState } from 'react';\nimport Window from '../components/Window';\nimport Vfs from './VFS';\nimport GFileListItem from './GFileListItem';\nimport \"./Finder.css\";\nimport Modal from \"../components/Modal\";\nimport Composer from \"./Composer\";\n\nclass Finder extends React.Component{\n    constructor(props){\n        super(props);\n        this.state = {\n            info:           \"finder\",\n            dirs:           props.dirs    || [], \n            current_node_id: props.current_node_id || 0, \n            fs_type:        props.fs_type || \"chrome\",\n            files:          props.files   || [], \n            edges:          props.edges   || [],\n            updateMessage:       \"\", \n            previewURL:         null,\n            previewText:        null,\n            previewFile:        null,\n            previewContentType: \"\",\n            fileBeingPublished: null,\n            isUploadingFiles:   false,\n            isPublishing:       false, \n            isComposing:        false,\n            composingContent:   null\n        }\n        this.vfs = Vfs(props.fs_type);\n        this.composer = React.createRef();\n    }\n\n\n    componentDidMount=async ()=>{\n        this.getFiles();\n    }\n\n    getFiles = async ()=>{\n        let files, edges;\n        [files, edges] = await this.vfs.get_files() || [[],[]];\n        this.setState({files: files, edges: edges});\n    }\n\n    get_full_path = (basename)=>{\n        return this.state.dirs.map(d=>d.name).concat(basename).join(\"/\");\n    }\n    add_file=async ()=>{\n        var filename = prompt(\"Enter file name\");\n        this.setState({\n            isComposing: true,\n            composingTitle: this.get_full_path(filename),\n            composingContent: this.state.composingContent || \"\"\n        })\n        \n        // let full_path  = this.get_full_path(filename);\n        // await this.vfs.file_put_content(full_path, content, true);\n        // this.getFiles();\n    }\n\n    upload_to_vfs =async (event)=>{\n        try{\n            var _files = event.target.files || [];\n            if(_files.length<1) return;\n            var uploads=[];\n            for(let i =0; i<_files.length; i++){\n                var item = _files.item(i);\n                item.fullPath = this.get_full_path(item.name);\n                uploads.push(item);\n            }\n            await this.vfs.upload_files(uploads,this.getFullBasePath(), (update)=>{\n                this.setState({updateMessage:update});\n            });\n            this.getFiles();\n        }catch(e){\n            alert(e.message);\n        }\n    }\n    prompt_array = (questions)=>{\n        var anwsers=[];\n        questions.forEach((q,idx)=>{\n            anwsers.push(prompt(\"question: \"+q));            \n        })\n        return anwsers;\n    }\n    renderPreview = ()=>{\n        const previewStyle={\n            position:\"absolute\",\n            left: \"55%\",\n            top: \"5%\",\n            height: \"95%\",\n            width: \"40%\",\n            backgroundColor:\"transparent\"\n        }\n        const file = this.state.previewFile;\n        if(!file) return null;\n        return (\n            <div style={previewStyle}>\n                {this.state.updateMessage ? (\n                <div className='row'>\n                    <div className='col-md-12' style={{height:30, overflow:'scroll'}}>\n                        {this.state.updateMessage}\n                    </div>\n                </div>) : null}\n                <div className='row'>\n                    {this.state.previewFile.fullPath}\n                </div>\n                <div className='row'>                \n                    <div className='md-col-10 ht-70 bg-light'> \n                        {this.renderPreviewContent()}\n                    </div>\n                </div>\n                <div className='row'>\n                    <div className='md-col-10'>\n                        <p>Size: {file.size}</p>\n                        <p>Type: {file.type}</p>\n                    </div>\n                </div>\n                <div className='row'>\n                    <div className='md-col-3'>\n                         <button class='btn btn-primary' onClick={(e)=>{\n                            this.setState({isPublishing:true, fileBeingPublished:file});\n                        }}> Publish </button>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    renderPreviewContent = () =>{\n        if(this.state.previewURL!==null){\n            if(this.state.previewContentType.includes(\"image\")){\n                return(<img style={{objectFit:\"fill\"}} \n                    width={320} height={400} src={this.state.previewURL}></img>);\n            }else{\n                return(<iframe width={320} height={400} src={this.state.previewURL}></iframe>)\n            }\n        }else if(this.state.previewText!==null){\n            return (<div height=\"50%\" width=\"100%\">{this.state.previewText}</div>);\n        }\n\n    }\n    renderFileInfo = (file) =>{\n        if(!file) return  (\"\");\n        return (\n            <table>\n                <tr>\n                    <td colspan={4}>\n                        <p>Size: {file.size}</p>\n                        <p>Type: {file.type}</p>\n                    </td>\n                </tr>               \n            </table>\n        )\n    }\n\n    clickedFile=async (file)=>{\n       \n        if(this.props.fs_type==='azure' ||this.props.fs_type==='market'){\n            try{\n                var contentType = '';\n                var fh = await this.vfs.file_get_stream(file.fullPath);\n                var buffers = [];\n                fh.onmessage = (e)=>{\n                    if (e.data && e.data.toString().startsWith(\"Content-Type: \")) {\n                        contentType = e.data.toString().replace(\"Content-Type: \",\"\");\n                    }\n                    else if (e.data && contentType) {\n                        buffers = buffers.concat(e.data);\n                        let url =  URL.createObjectURL(new Blob(buffers),{ type: contentType });\n                        this.setState({\n                            previewFile:file, \n                            previewURL:url, \n                            previewContentType: contentType\n                        });\n                    }\n                }\n\n            }catch(e){\n                alert(e.lineNumber+\":\"+e.message);\n            }\n            return;\n        }\n        try{\n            var preview_content = await this.vfs.file_get_content(file.fullPath);      \n            preview_content.type =  preview_content.type || \"text\";            \n            if(preview_content.type==='text'){\n                this.setState({\n                    previewURL: null,\n                    previewText:preview_content.payload, \n                    previewFile:preview_content.file})\n            }else if(preview_content.type==='image'){\n                 this.setState({\n                     previewText: null, \n                     previewURL:preview_content.payload,  \n                     previewFile:preview_content.file\n                    });\n            }\n        }catch(e){\n            alert(e.lineNumber+\":\"+e.message);\n        }\n\n    }\n\n    clickedDir = async(dir)=>{\n       let new_dirs =this.state.dirs.concat(dir);\n       this.setState({dirs:new_dirs, current_node_id:dir.id});\n    }\n    backDir = (dirId) =>{\n        if(dirId===0){\n            this.setState({\n                dirs:[], \n                current_node_id:0\n            });\n            return;\n        }\n\n        let new_dirs = [];\n        let i;\n        for(i in  this.state.dirs){\n            new_dirs.push(this.state.dirs[i]);\n            if(dirId == this.state.dirs[i].id){\n                break;\n            }\n        }\n        this.setState({\n            dirs:new_dirs, \n            current_node_id:dirId\n        });\n    }\n    getFullBasePath=()=>{\n        return this.state.fs_type+\"/\"+this.state.dirs.map(d=>d.name).join(\"/\");\n    }\n    renderBreadCrumb=()=>{\n        const headerStyle={\n            position:\"absolute\",\n            top:0,\n            left:0,\n            height:\"20px\",\n            width:\"100%\",\n        }\n        return(\n            <span style={headerStyle}>\n            <a onClick={()=>{\n               this.backDir(0)\n               return false;\n            }}>{this.state.fs_type+\" >\"}</a>\n\n            {this.state.dirs.map(dir=>{\n               return (<a onClick={()=>{\n                   this.backDir(dir.id)\n                   return false;\n               }}>{dir.name+\" >\"}</a>)\n            })}\n            </span>\n        )\n    }\n    renderBody2 = ()=>{\n       let files_displayed=[];\n       const _files = this.state.files || [];\n\n\n       if(this.state.edges==='flat'){\n          files_displayed = _files;\n       }else{\n            const _edges = this.state.edges[this.state.current_node_id] || [];\n            _edges.forEach((node_id)=>{\n                files_displayed.push(_files[node_id])\n           })\n       }\n\n        const bodyStyle={\n            position:\"absolute\",\n            top: \"20px\",\n            height: \"calc(100% - 60px)\",\n            left: 0,\n            color:\"#D7D7D7\",\n            width:\"47%\",\n            overflow:\"scroll\",\n            paddingLeft:\"2%\",\n            backgroundColor:\"#2A2A2A\"\n        }\n        const ctrlStyle={\n            position:\"absolute\",\n            bottom: \"0px\",\n            height: \"40px\",\n            width: \"95%\",\n            left: 0,\n            float: \"right\",\n            padding: 5\n\n        } \n        return (\n            <div>\n                <div className='file_list' style={bodyStyle}>\n                    {files_displayed.length===0 ? (<div>NO Files</div>) \n                    : files_displayed.map((file,i) =>{\n                      return (\n                        <GFileListItem \n                            vfs = {this.vfs}\n                            rowIndex={i}\n                            file={file} \n                            clickedDir={this.clickedDir}\n                            clickedFile={this.clickedFile}\n                        />\n                    )\n                  })}\n                </div>\n                <div className='Controls' style={ctrlStyle}>\n                    <button className='btn primary' onClick={this.add_file}>Compose</button>\n                    {'\\u00A0'}{'\\u00A0'}\n                    {this.state.isUploadingFiles == true ? (\n                         <input type='file' multiple \n                         className='btn primary'\n                          onChange={this.upload_to_vfs} />\n                    ) : (<button className='btn' onClick={()=>{\n                        this.setState({isUploadingFiles:true});\n                    }}>Upload</button>)}\n                </div>\n             </div>\n        )\n    }\n    publishFile=async (responses)=>{\n        let xpath = await Vfs.upload_file_market(this.state.fileBeingPublished);\n        Vfs.api_post_json(\"/listing\",{\n            uuid: this.props.userInfo.uuid,\n            title: responses.title,\n            price: responses.price,\n            url:    xpath, \n            tags: responses.tags.split(\",\")\n        }).then(resp=>{\n            if(resp.status==='OK'){\n                alert(\"Posting Successful\");\n            }\n            this.setState({isPublishing:false});\n        }).catch(err=>{\n           alert(err.message);\n           this.setState({isPublishing:false});\n        })\n    }\n    render() {\n      return (\n      <Window width={1000} height={600} left={220} ipc={this.props.ipc} icon='computer' title='My Computer'>\n          <div className=\"anchor\">\n              {this.renderBreadCrumb()}\n              {this.renderBody2()}\n              {this.renderPreview()}\n          </div>\n          {this.state.isPublishing ? \n            (<Modal \n                onSubmit={this.publishFile}\n                onClose={()=>{this.setState({isPublishing:false})}}\n                questions={['title', 'price', 'tags']}\n                initialAnswers={{\n                    'title': this.state.fileBeingPublished.name,\n                    'price': 10, \n                    'tags': \"newFile\"\n                }}\n                questionTypes = {['string', 'numeric', 'array']}\n                title='Publish Content' />) \n          : null}\n\n          {this.state.isComposing !== false \n            ? (\n            <Composer\n                vfs={this.vfs}\n                mode={\"javascript\"}\n                path={this.getFullBasePath()+\"/\"+this.state.composingTitle}\n                value={this.state.composingContent || \"\"}\n                onChange={content=>this.setState({composingContent: content})}\n                name={this.state.composingTitle}\n                onClose={()=>{this.setState({isComposing:false})}}\n            ></Composer>) \n            : null}\n\n      </Window>)\n    }\n}\nexport default Finder;\n","import React from \"react\";\nimport \"./App.css\";\nimport Terminal from \"./Terminal\";\nimport HUD from \"./HUD\";\nimport ListView from \"./components/ListView\";\nimport Camera from \"./Camera\";\nimport Broadcast from \"./Broadcast/Broadcast\";\nimport Watch from \"./Broadcast/Watch\";\nimport UIWebView from \"./components/UIWebView\";\n\nimport AppIconGrid from \"./AppIconGrid\";\nimport Finder from \"./FileExplorer/Finder\";\nimport SearchBar from \"./SearchBar\";\nimport * as API from \"./APICalls\";\nimport Composer from \"./FileExplorer/Composer\";\n\nclass Desktop extends React.Component {\n  constructor(props) {\n    super(props);\n    this.ipc = this.ipc.bind(this);\n    this.state = {\n      processes: [],\n      // processes:[{name:\"tty\", state:\"on\"}],\n      userInfo: { name: \"guest\", xp: 0, gold: 0 },\n      quests: [],\n      icons: [\n        {\n          name: \"folder\",\n          title: \"Local Files\",\n          cmd: \"finder\",\n          args: [\"chrome\"],\n        },\n        {\n          name: \"folder\",\n          title: \"Public Files\",\n          cmd: \"finder\",\n          args: [\"azure\"],\n        },\n        {\n          name: \"folder\",\n          title: \"Content Market\",\n          cmd: \"finder\",\n          args: [\"market\"],\n        },\n        // {name:\"folder\",     title:\"Dropbox Files\",    cmd:\"finder\", args:[\"dropbox\"]},\n        // {name:\"folder\",     title:\"Facebook Files\",    cmd:\"finder\", args:[\"fb\"]},\n        { name: \"terminal\", title: \"terminal\", cmd: \"tty\", args: [] },\n        {\n          name: \"broadcast-tower\",\n          title: \"Broadcast\",\n          cmd: \"stream\",\n          args: [],\n        },\n        {\n          name: \"play-circle\",\n          title: \"Watch Hearthstone\",\n          cmd: \"watch\",\n          args: [\"r5rogue\"],\n        },\n        {\n          name: \"shipping-fast\",\n          title: \"Write Javascript\",\n          cmd: \"compose\",\n          args: [\"javascript\"],\n        },\n      ],\n      files: [],\n    };\n  }\n\n  componentDidMount() {\n    if (window.location.pathname !== \"/\") {\n      var xpath = window.location.pathname.split(\"/\").splice(1);\n      if (xpath.length === 1) {\n        this.ipc(\"watch\", xpath);\n      } else if (xpath.length == 2) {\n        this.ipc(xpath[0], xpath.splice(1));\n      }\n    } else if (window.location.search) {\n      var t = window.location.search.replace(\"?\", \"\").split(\"/\");\n      const cmd = t[0];\n      const args = t.splice(1);\n      this.ipc(cmd, args);\n    } else {\n      this.ipc(\"tty\", []);\n    }\n    const uuid = API.getUUID();\n    API.api_get_json(\"/api/checkin?uuid=\" + uuid)\n      .then((_userInfo) => {\n        this.setState({ userInfo: _userInfo });\n      })\n      .catch((err) => {\n        //alert(\"check in failed\");\n      });\n  }\n\n  ipc(cmd, args) {\n    console.log(\"desktop ipc \", cmd, args);\n    switch (cmd) {\n      case \"files\":\n        const fileList = args;\n        this.setFiles(fileList);\n\n        this.setState({ processes: plist });\n        break;\n      case \"close\":\n        const pid = args[0];\n        const list = this.state.processes;\n        list[pid] = \"closed\";\n        this.setState({ processes: list });\n        break;\n      case \"edit\":\n        var plist = this.state.processes.concat({\n          name: \"iframe\",\n          url: \"/api/files/edit?url=\" + args[0] + \"&context=\" + args[1],\n        });\n        this.setState({ processes: plist });\n        break;\n      case \"cam\":\n      case \"camera\":\n      case \"broadcast\":\n      case \"stream\":\n      case \"watch\":\n      case \"tty\":\n      case \"compose\":\n      case \"finder\":\n        var plist = this.state.processes.concat({ name: cmd, args: args });\n        this.setState({ processes: plist });\n        break;\n      case \"hud-update\":\n        this.setState({ userInfo: args });\n        break;\n      case \"questlist\":\n        this.setState({ quests: args });\n        break;\n    }\n  }\n\n  renderBody() {\n    return this.state.processes.map((proc, pid) => {\n      console.log(proc, pid);\n      if (proc.state === \"off\") return null;\n      if (proc.name === \"tty\") {\n        return <Terminal key=\"tty1\" pid={pid} title=\"Telnet\" ipc={this.ipc} />;\n      } else if (proc.name === \"camera\") {\n        return (\n          <Camera\n            userInfo={this.state.userInfo}\n            pid={pid}\n            title=\"Face 2 Face\"\n            ipc={this.ipc}\n          />\n        );\n      } else if (proc.name === \"stream\") {\n        return (\n          <Broadcast\n            args={proc.args}\n            channel={proc.args[0] || \"\"}\n            pid={pid}\n            title=\"Broadcast\"\n            ipc={this.ipc}\n          />\n        );\n      } else if (proc.name === \"watch\") {\n        var channelName = proc.args[0] || \"default\";\n        return (\n          <Watch\n            userInfo={this.state.userInfo}\n            channelName={channelName}\n            pid={pid}\n            title=\"Watch\"\n            ipc={this.ipc}\n          />\n        );\n      } else if (proc.name === \"iframe\") {\n        return <iframe width=\"90%\" height=\"80%\" src={proc.url}></iframe>;\n      } else if (proc.name === \"finder\") {\n        var type = proc.args[0] || \"\";\n        return (\n          <Finder\n            userInfo={this.state.userInfo}\n            ipc={this.ipc}\n            title=\"Finder\"\n            fs_type={type}\n            ipc={this.ipc}\n          ></Finder>\n        );\n      } else if (proc.name === \"compose\") {\n        return (\n          <Composer\n            userInfo={this.state.userInfo}\n            title=\"write code\"\n            ipc={this.ipc}\n          ></Composer>\n        );\n      }\n    });\n  }\n  renderHud() {\n    return this.state.userInfo ? (\n      <HUD\n        username={this.state.userInfo.username}\n        cwd={this.state.userInfo.cwd}\n        fname={this.state.userInfo.fname}\n        xp={this.state.userInfo.xp}\n        gold={this.state.userInfo.gold}\n      />\n    ) : null;\n  }\n  renderSearchBar = () => {\n    return <SearchBar></SearchBar>;\n  };\n  renderQuestView() {\n    return (\n      <ListView\n        className=\"quest-list\"\n        title=\"quests\"\n        list={this.state.quests}\n      />\n    );\n  }\n  renderBackground() {\n    return <AppIconGrid icons={this.state.icons} ipc={this.ipc}></AppIconGrid>;\n  }\n  render() {\n    return (\n      <div className=\"desktop\">\n        <nav\n          style={{ width: \"100vw\", height: \"18px\" }}\n          className=\"navbar navbar-light bg-light\"\n        >\n          <a className=\"navbar-brand\" href=\"#\">\n            GrepAwk\n          </a>\n\n          <ul className=\"navbar-nav\">\n            <li className=\"nav-item\">\n              <a className=\"nav-link btn\" href=\"#\">\n                Compose\n              </a>\n            </li>\n          </ul>\n          {this.renderHud()}\n        </nav>\n        <div\n          style={{\n            top: \"0\",\n            position: \"absolute\",\n            width: \"100vw\",\n            height: \"calc(100% - 18px)\",\n          }}\n        >\n          {this.renderBackground()}\n          {this.renderBody()}\n          {this.renderQuestView()}\n          {this.renderSearchBar()}\n        </div>\n      </div>\n    );\n  }\n}\nexport default Desktop;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\n//import * as serviceWorker from './serviceWorker';\nimport Desktop from \"./Desktop\";\nimport Finder from \"./FileExplorer/Finder\";\nReactDOM.render(<Desktop />, document.getElementById(\"root\"));\n//serviceWorker.unregister();\n"],"sourceRoot":""}